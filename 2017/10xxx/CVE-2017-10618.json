{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2017-10-11T09:00",
        "ID": "CVE-2017-10618",
        "STATE": "PUBLIC",
        "TITLE": "Junos: RPD core due to BGP UPDATE with malformed optional transitive attributes"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "",
                                            "version_value": "13.3 prior to 13.3R10-S2"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "14.1 prior to 14.1R8-S4, 14.1R9"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "14.1X50 prior to 14.1X50-D185"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "14.1X53 prior to 14.1X53-D45, 14.1X53-D50"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "14.2 prior to 14.2R7-S7, 14.2R8"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "15.1 prior to 15.1F5-S8, 15.1F6-S7, 15.1R5-S6, 15.1R6-S2, 15.1R7"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "15.1X49 prior to 15.1X49-D100"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "15.1X53 prior to 15.1X53-D64, 15.1X53-D70"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "16.1 prior to 16.1R3-S4, 16.1R4-S3, 16.1R5"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "16.2 prior to 16.2R1-S5, 16.2R2"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "17.1 prior to 17.1R1-S3, 17.1R2"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "17.2 prior to 17.2R1-S2, 17.2R2"
                                        },
                                        {
                                            "platform": "",
                                            "version_value": "17.2X75 prior to 17.2X75-D50"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This only affects devices with 'bgp-error-tolerance' feature enabled."
        }
    ],
    "credit": [],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "When the 'bgp-error-tolerance' feature &#xe2;&#x80;\" designed to help mitigate remote session resets from malformed path attributes &#xe2;&#x80;\" is enabled, a BGP UPDATE containing a specifically crafted set of transitive attributes can cause the RPD routing process to crash and restart. Devices with BGP enabled that do not have 'bgp-error-tolerance' configured are not vulnerable to this issue. Affected releases are Juniper Networks Junos OS 13.3 prior to 13.3R10-S2; 14.1 prior to 14.1R8-S4, 14.1R9; 14.1X50 prior to 14.1X50-D185; 14.1X53 prior to 14.1X53-D45, 14.1X53-D50; 14.2 prior to 14.2R7-S7, 14.2R8; 15.1 prior to 15.1F5-S8, 15.1F6-S7, 15.1R5-S6, 15.1R6-S2, 15.1R7; 15.1X49 prior to 15.1X49-D100; 15.1X53 prior to 15.1X53-D64, 15.1X53-D70; 16.1 prior to 16.1R3-S4, 16.1R4-S3, 16.1R5; 16.2 prior to 16.2R1-S5, 16.2R2; 17.1 prior to 17.1R1-S3, 17.1R2; 17.2 prior to 17.2R1-S2, 17.2R2; 17.2X75 prior to 17.2X75-D50. No other Juniper Networks products or platforms are affected by this issue."
            }
        ]
    },
    "exploit": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability, however, the issue has been seen in a production network.",
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.0"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of service"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://www.juniper.net/documentation/en_US/junos/topics/concept/bgp-error-handling-overview.html",
                "refsource": "MISC",
                "url": "https://www.juniper.net/documentation/en_US/junos/topics/concept/bgp-error-handling-overview.html"
            },
            {
                "name": "https://kb.juniper.net/JSA10820",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA10820"
            },
            {
                "name": "https://www.juniper.net/documentation/en_US/junos/topics/reference/configuration-statement/bgp-error-tolerance.html",
                "refsource": "MISC",
                "url": "https://www.juniper.net/documentation/en_US/junos/topics/reference/configuration-statement/bgp-error-tolerance.html"
            }
        ]
    },
    "solution": "The following software releases have been updated to resolve this specific issue: 13.3R10-S2, 14.1R8-S4, 14.1R9, 14.1X50-D185, 14.1X53-D45, 14.1X53-D50, 14.2R7-S7, 14.2R8, 15.1F5-S8, 15.1F6-S7, 15.1R5-S6, 15.1R6-S2, 15.1R7, 15.1X49-D100, 15.1X53-D64, 15.1X53-D70, 16.1R3-S4, 16.1R4-S3, 16.1R5, 16.2R1-S5, 16.2R2, 17.1R1-S3, 17.1R2, 17.2R1-S2, 17.2R2, 17.2X75-D50, 17.3R1, and all subsequent releases.\n\nThis issue is being tracked as PR 1279204 and is visible on the Customer Support website.",
    "work_around": [
        {
            "lang": "eng",
            "value": "If 'bgp-error-tolerance' is enabled, disabling this option under 'protocols bgp' will mitigate this issue.\n\nNote that when the error handling feature is off, the router is vulnerable to session resets from malformed path attributes.  However, this is RFC 4271 compliant behavior.\n"
        }
    ]
}