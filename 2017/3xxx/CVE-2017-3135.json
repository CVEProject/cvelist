{
    "CVE_data_meta": {
        "ASSIGNER": "security-officer@isc.org",
        "DATE_PUBLIC": "2017-02-08T00:00:00.000Z",
        "ID": "CVE-2017-3135",
        "STATE": "PUBLIC",
        "TITLE": "Combination of DNS64 and RPZ Can Lead to Crash"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "BIND 9",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_name": "BIND 9",
                                            "version_value": "9.8.8, 9.9.3-S1 -> 9.9.9-S7, 9.9.3 -> 9.9.9-P5, 9.9.10b1, 9.10.0 -> 9.10.4-P5, 9.10.5b1, 9.11.0 -> 9.11.0-P2, 9.11.1b1"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "ISC"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "Servers utilizing both DNS64 and RPZ are potentially susceptible to encountering this condition."
        }
    ],
    "credit": [
        {
            "lang": "eng",
            "value": "ISC would like to thank Ramesh Damodaran(Infoblox) and Aliaksandr Shubnik (Infoblox) for reporting the issue and assisting us in the investigation."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "Under some conditions when using both DNS64 and RPZ to rewrite query responses, query processing can resume in an inconsistent state leading to either an INSIST assertion failure or an attempt to read through a NULL pointer. Affects BIND 9.8.8, 9.9.3-S1 -> 9.9.9-S7, 9.9.3 -> 9.9.9-P5, 9.9.10b1, 9.10.0 -> 9.10.4-P5, 9.10.5b1, 9.11.0 -> 9.11.0-P2, 9.11.1b1."
            }
        ]
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.0"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Servers utilizing both DNS64 and RPZ are potentially susceptible to encountering this condition.  When this condition occurs, it will result in either an INSIST assertion failure (and subsequent abort) or an attempt to read through a NULL pointer.  On most platforms a NULL pointer read leads to a segmentation fault (SEGFAULT), which causes the process to be terminated.\n\nOnly servers which are configured to simultaneously use both Response Policy Zones (RPZ) and DNS64 (a method for synthesizing AAAA records from A records) can be affected by this vulnerability."
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "GLSA-201708-01",
                "refsource": "GENTOO",
                "url": "https://security.gentoo.org/glsa/201708-01"
            },
            {
                "name": "RHSA-2017:0276",
                "refsource": "REDHAT",
                "url": "http://rhn.redhat.com/errata/RHSA-2017-0276.html"
            },
            {
                "name": "https://security.netapp.com/advisory/ntap-20180926-0005/",
                "refsource": "CONFIRM",
                "url": "https://security.netapp.com/advisory/ntap-20180926-0005/"
            },
            {
                "name": "https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03747en_us",
                "refsource": "CONFIRM",
                "url": "https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03747en_us"
            },
            {
                "name": "96150",
                "refsource": "BID",
                "url": "http://www.securityfocus.com/bid/96150"
            },
            {
                "name": "1037801",
                "refsource": "SECTRACK",
                "url": "http://www.securitytracker.com/id/1037801"
            },
            {
                "name": "DSA-3795",
                "refsource": "DEBIAN",
                "url": "https://www.debian.org/security/2017/dsa-3795"
            },
            {
                "name": "https://kb.isc.org/docs/aa-01453",
                "refsource": "CONFIRM",
                "url": "https://kb.isc.org/docs/aa-01453"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "Upgrade to the patched release most closely related to your current version of BIND. These can all be downloaded from http://www.isc.org/downloads.\n\n    BIND 9 version 9.9.9-P6\n    BIND 9 version 9.10.4-P6\n    BIND 9 version 9.11.0-P3\n\nBIND Supported Preview Edition is a special feature preview branch of BIND provided to eligible ISC support customers.\n\n    BIND 9 version 9.9.9-S8"
        }
    ],
    "source": {
        "discovery": "EXTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "While it is possible to avoid the condition by removing either DNS64 or RPZ from the configuration, or by carefully restricting the contents of the policy zone, for an affected configuration the most practical and safest course of action is to upgrade to a version of BIND without this vulnerability."
        }
    ]
}