{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2018-04-11T16:00:00.000Z",
        "ID": "CVE-2018-0018",
        "STATE": "PUBLIC",
        "TITLE": "SRX Series: A crafted packet may lead to information disclosure and firewall rule bypass during compilation of IDP policies."
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "affected": "<",
                                            "platform": "SRX",
                                            "version_name": "12.1X46",
                                            "version_value": "12.1X46-D60"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "SRX",
                                            "version_name": "12.3X48",
                                            "version_value": "12.3X48-D35"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "SRX",
                                            "version_name": "15.1X49",
                                            "version_value": "15.1X49-D60"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue only affects SRX Series devices with IDP configured."
        }
    ],
    "credit": [
        {
            "lang": "eng",
            "value": "Craig Dods, formerly of IBM Security"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On SRX Series devices during compilation of IDP policies, an attacker sending specially crafted packets may be able to bypass firewall rules, leading to information disclosure which an attacker may use to gain control of the target device or other internal devices, systems or services protected by the SRX Series device. This issue only applies to devices where IDP policies are applied to one or more rules. Customers not using IDP policies are not affected. Depending on if the IDP updates are automatic or not, as well as the interval between available updates, an attacker may have more or less success in performing reconnaissance or bypass attacks on the victim SRX Series device or protected devices. ScreenOS with IDP is not vulnerable to this issue. Affected releases are Juniper Networks Junos OS: 12.1X46 versions prior to 12.1X46-D60 on SRX; 12.3X48 versions prior to 12.3X48-D35 on SRX; 15.1X49 versions prior to 15.1X49-D60 on SRX."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "LOW",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "CHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N",
            "version": "3.0"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Information disclosure\nfirewall bypass\nprotocol manipulation\nfirewall rule evasion\n"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA10846",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA10846"
            },
            {
                "name": "1040786",
                "refsource": "SECTRACK",
                "url": "http://www.securitytracker.com/id/1040786"
            },
            {
                "name": "103748",
                "refsource": "BID",
                "url": "http://www.securityfocus.com/bid/103748"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 12.1X46-D60, 12.3X48-D35, 15.1X49-D60, 17.3R1, and all subsequent releases.  \n\nAdditionally, customers should download and apply the latest sigpack for IDP signatures."
        }
    ],
    "source": {
        "advisory": "JSA10846",
        "defect": [
            "1151743"
        ],
        "discovery": "INTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "Customers using cluster configurations may break the cluster configuration, disable traffic on one node, update the IDP policy, reintroduce this updated node as a standalone device, directing all traffic to it, instead of the current standalone, and then do the same with the secondary node, and then reintroduce cluster configuration to both devices.  For this workaround to be most effective, customers should disable automatic updates and manually download IDP signature updates.\n\nAlternately, cluster customers using load balancers may break cluster, run individual side-by-side configurations, off load all traffic from one node via load balancers to another node, then update the IDP policy manually on the idle node, lastly, flip flop this operation, and then return to side-by-side or cluster mode operation.\n\nCustomers unable to utilize similar design scenarios as workarounds such as the above should instead take fixes where available.\n\n  \n\n\n"
        }
    ]
}