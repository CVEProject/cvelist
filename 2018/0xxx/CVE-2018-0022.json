{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2018-04-11T16:00:00.000Z",
        "ID": "CVE-2018-0022",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: Mbuf leak due to processing MPLS packets in VPLS network."
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "affected": "<",
                                            "version_name": "12.1X46",
                                            "version_value": "12.1X46-D76"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "12.3X48",
                                            "version_value": "12.3X48-D66, 12.3X48-D70"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "14.1",
                                            "version_value": "14.1R9"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "14.1X53",
                                            "version_value": "14.1X53-D47"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "14.2",
                                            "version_value": "14.2R8"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "15.1",
                                            "version_value": "15.1F2-S19, 15.1F6-S10, 15.1R4-S9, 15.1R5-S7, 15.1R6-S4, 15.1R7"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "15.1X49",
                                            "version_value": "15.1X49-D131, 15.1X49-D140"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "EX2300/EX3400",
                                            "version_name": "15.1X53",
                                            "version_value": "15.1X53-D58"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5200/QFX5110",
                                            "version_name": "15.1X53",
                                            "version_value": "15.1X53-D233"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "NFX",
                                            "version_name": "15.1X53",
                                            "version_value": "15.1X53-D471"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX10",
                                            "version_name": "15.1X53",
                                            "version_value": "15.1X53-D66"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "16.1",
                                            "version_value": "16.1R3-S8, 16.1R4-S6, 16.1R5"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "16.2",
                                            "version_value": "16.2R1-S6, 16.2R2-S5, 16.2R3"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "17.1",
                                            "version_value": "17.1R1-S7, 17.1R2-S6, 17.1R3"
                                        },
                                        {
                                            "affected": "<",
                                            "version_name": "17.2",
                                            "version_value": "17.2R1-S5, 17.2R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue only affects IPv4.\n"
        },
        {
            "lang": "eng",
            "value": "This issue does not affect IPv6."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A Junos device with VPLS routing-instances configured on one or more interfaces may be susceptible to an mbuf leak when processing a specific MPLS packet. Approximately 1 mbuf is leaked per each packet processed. The number of mbufs is platform dependent. The following command provides the number of mbufs that are currently in use and maximum number of mbufs that can be allocated on a platform: > show system buffers 2437/3143/5580 mbufs in use (current/cache/total) Once the device runs out of mbufs it will become inaccessible and a restart will be required. This issue only affects end devices, transit devices are not affected. Affected releases are Juniper Networks Junos OS with VPLS configured running: 12.1X46 versions prior to 12.1X46-D76; 12.3X48 versions prior to 12.3X48-D66, 12.3X48-D70; 14.1 versions prior to 14.1R9; 14.1X53 versions prior to 14.1X53-D47; 14.2 versions prior to 14.2R8; 15.1 versions prior to 15.1F2-S19, 15.1F6-S10, 15.1R4-S9, 15.1R5-S7, 15.1R6-S4, 15.1R7; 15.1X49 versions prior to 15.1X49-D131, 15.1X49-D140; 15.1X53 versions prior to 15.1X53-D58 on EX2300/EX3400; 15.1X53 versions prior to 15.1X53-D233 on QFX5200/QFX5110; 15.1X53 versions prior to 15.1X53-D471 on NFX; 15.1X53 versions prior to 15.1X53-D66 on QFX10; 16.1 versions prior to 16.1R3-S8, 16.1R4-S6, 16.1R5; 16.2 versions prior to 16.2R1-S6, 16.2R2-S5, 16.2R3; 17.1 versions prior to 17.1R1-S7, 17.1R2-S6, 17.1R3; 17.2 versions prior to 17.2R1-S5, 17.2R2."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.0"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "denial of service"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "103740",
                "refsource": "BID",
                "url": "http://www.securityfocus.com/bid/103740"
            },
            {
                "name": "https://kb.juniper.net/JSA10855",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA10855"
            },
            {
                "name": "1040790",
                "refsource": "SECTRACK",
                "url": "http://www.securitytracker.com/id/1040790"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 12.1X46-D76, 12.3X48-D66, 12.3X48-D70, 14.1R9, 14.1X53-D47, 14.2R8, 15.1F2-S19, 15.1F6-S10, 15.1R4-S9, 15.1R5-S7, 15.1R6-S4, 15.1R7, 15.1X49-D131, 15.1X49-D140, 15.1X53-D233, 15.1X53-D471, 15.1X53-D58, 15.1X53-D66, 16.1R3-S8, 16.1R4-S6, 16.1R5, 16.2R1-S6, 16.2R2-S5, 16.2R3, 17.1R1-S7, 17.1R2-S6, 17.1R3, 17.2R1-S5, 17.2R2, 17.3R1 and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA10855",
        "defect": [
            "1272898"
        ],
        "discovery": "INTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There is no viable workaround for this issue."
        }
    ]
}