{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2018-10-10T16:00:00.000Z",
        "ID": "CVE-2018-0054",
        "STATE": "PUBLIC",
        "TITLE": "QFX5000/EX4600 Series: Routing protocol flap upon receipt of high rate of Ethernet frames"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "14.1X53",
                                            "version_value": "14.1X53-D47"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "15.1",
                                            "version_value": "15.1R7, 15.1R8"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "15.1X53",
                                            "version_value": "15.1X53-D233"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "16.1",
                                            "version_value": "16.1R7"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "16.2",
                                            "version_value": "16.2R3"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "17.1",
                                            "version_value": "17.1R2-S9, 17.1R3"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "17.2",
                                            "version_value": "17.2R2-S6, 17.2R3"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "17.2X75",
                                            "version_value": "17.2X75-D42"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "17.3",
                                            "version_value": "17.3R3"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2"
                                        },
                                        {
                                            "affected": "<",
                                            "platform": "QFX5000 Series and EX4600",
                                            "version_name": "18.1",
                                            "version_value": "18.1R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On QFX5000 Series and EX4600 switches, a high rate of Ethernet pause frames or an ARP packet storm received on the management interface (fxp0) can cause egress interface congestion, resulting in routing protocol packet drops, such as BGP, leading to peering flaps. The following log message may also be displayed: fpc0 dcbcm_check_stuck_buffers: Buffers are stuck on queue 7 of port 45 This issue only affects the QFX5000 Series products (QFX5100, QFX5110, QFX5200, QFX5210) and the EX4600 switch. No other platforms are affected by this issue. Affected releases are Juniper Networks Junos OS: 14.1X53 versions prior to 14.1X53-D47 on QFX5000 Series and EX4600; 15.1 versions prior to 15.1R7, 15.1R8 on QFX5000 Series and EX4600; 15.1X53 versions prior to 15.1X53-D233 on QFX5000 Series and EX4600; 16.1 versions prior to 16.1R7 on QFX5000 Series and EX4600; 16.2 versions prior to 16.2R3 on QFX5000 Series and EX4600; 17.1 versions prior to 17.1R2-S9, 17.1R3 on QFX5000 Series and EX4600; 17.2 versions prior to 17.2R2-S6, 17.2R3 on QFX5000 Series and EX4600; 17.2X75 versions prior to 17.2X75-D42 on QFX5000 Series and EX4600; 17.3 versions prior to 17.3R3 on QFX5000 Series and EX4600; 17.4 versions prior to 17.4R2 on QFX5000 Series and EX4600; 18.1 versions prior to 18.1R2 on QFX5000 Series and EX4600."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.0"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of service"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA10888",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA10888"
            },
            {
                "name": "1041855",
                "refsource": "SECTRACK",
                "url": "http://www.securitytracker.com/id/1041855"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 14.1X53-D47, 15.1R7, 15.1R8, 15.1X53-D233, 16.1R7, 16.2R3, 17.1R2-S9, 17.1R3, 17.2R2-S6, 17.2R3, 17.2X75-D42, 17.3R3, 17.4R2, 18.1R2, 18.2R1, 18.2X75-D5, and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA10888",
        "defect": [
            "1343597"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "For BGP, configure 'ether-options no-flow-control' on the BGP interface.\n"
        },
        {
            "lang": "eng",
            "value": "Configure the lossless percentage of ingress shared buffer pool to be greater than the egress shared buffer pool.  For example:\n\n  [edit class-of-service shared-buffer]\n  user@switch# set ingress buffer-partition lossless percent <percent>\n  user@switch# set egress buffer-partition lossless percent <percent>\n"
        }
    ]
}