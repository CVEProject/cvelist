{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2018-14634",
        "ASSIGNER": "secalert@redhat.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An integer overflow flaw was found in the Linux kernel's create_elf_tables() function. An unprivileged local user with access to SUID (or otherwise privileged) binary could use this flaw to escalate their privileges on the system."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Integer Overflow or Wraparound",
                        "cweId": "CWE-190"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Red Hat",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Red Hat Enterprise Linux 6",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:2.6.32-754.6.3.el6",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 6.4 Advanced Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:2.6.32-358.94.1.el6",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 6.5 Advanced Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:2.6.32-431.93.2.el6",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 6.6 Advanced Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:2.6.32-504.76.2.el6",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 6.6 Telco Extended Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:2.6.32-504.76.2.el6",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 6.7 Extended Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:2.6.32-573.65.2.el6",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 7",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.10.0-862.14.4.rt56.821.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:3.10.0-862.14.4.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 7.2 Advanced Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.10.0-327.76.1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 7.2 Telco Extended Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.10.0-327.76.1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 7.2 Update Services for SAP Solutions",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.10.0-327.76.1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 7.3 Extended Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.10.0-514.61.1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise Linux 7.4 Extended Update Support",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.10.0-693.43.1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Enterprise MRG 2",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "1:3.10.0-693.43.1.rt56.630.el6rt",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://usn.ubuntu.com/3775-1/",
                "refsource": "MISC",
                "name": "https://usn.ubuntu.com/3775-1/"
            },
            {
                "url": "https://usn.ubuntu.com/3775-2/",
                "refsource": "MISC",
                "name": "https://usn.ubuntu.com/3775-2/"
            },
            {
                "url": "https://usn.ubuntu.com/3779-1/",
                "refsource": "MISC",
                "name": "https://usn.ubuntu.com/3779-1/"
            },
            {
                "url": "http://www.openwall.com/lists/oss-security/2021/07/20/2",
                "refsource": "MISC",
                "name": "http://www.openwall.com/lists/oss-security/2021/07/20/2"
            },
            {
                "url": "http://www.securityfocus.com/bid/105407",
                "refsource": "MISC",
                "name": "http://www.securityfocus.com/bid/105407"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:2748",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:2748"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:2763",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:2763"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:2846",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:2846"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:2924",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:2924"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:2925",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:2925"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:2933",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:2933"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:3540",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:3540"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:3586",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:3586"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:3590",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:3590"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:3591",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:3591"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:3643",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:3643"
            },
            {
                "url": "https://access.redhat.com/security/cve/CVE-2018-14634",
                "refsource": "MISC",
                "name": "https://access.redhat.com/security/cve/CVE-2018-14634"
            },
            {
                "url": "https://access.redhat.com/security/vulnerabilities/mutagen-astronomy",
                "refsource": "MISC",
                "name": "https://access.redhat.com/security/vulnerabilities/mutagen-astronomy"
            },
            {
                "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1624498",
                "refsource": "MISC",
                "name": "https://bugzilla.redhat.com/show_bug.cgi?id=1624498"
            },
            {
                "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-14634",
                "refsource": "MISC",
                "name": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-14634"
            },
            {
                "url": "https://security.netapp.com/advisory/ntap-20190204-0002/",
                "refsource": "MISC",
                "name": "https://security.netapp.com/advisory/ntap-20190204-0002/"
            },
            {
                "url": "https://security.paloaltonetworks.com/CVE-2018-14634",
                "refsource": "MISC",
                "name": "https://security.paloaltonetworks.com/CVE-2018-14634"
            },
            {
                "url": "https://support.f5.com/csp/article/K20934447?utm_source=f5support&amp%3Butm_medium=RSS",
                "refsource": "MISC",
                "name": "https://support.f5.com/csp/article/K20934447?utm_source=f5support&amp%3Butm_medium=RSS"
            },
            {
                "url": "https://www.exploit-db.com/exploits/45516/",
                "refsource": "MISC",
                "name": "https://www.exploit-db.com/exploits/45516/"
            },
            {
                "url": "https://www.openwall.com/lists/oss-security/2018/09/25/4",
                "refsource": "MISC",
                "name": "https://www.openwall.com/lists/oss-security/2018/09/25/4"
            }
        ]
    },
    "work_around": [
        {
            "lang": "en",
            "value": "To mitigate the issue:\n\nEnable and install kernel-debuginfo packages as per https://access.redhat.com/solutions/666123\n\n1) On the host, save the following in a file with the \".stp\" extension:\n\n// CVE-2018-14634\n//\n// Theory of operations: adjust the thread's # rlimit-in-effect around\n// calls to the vulnerable get_arg_page() function so as to encompass\n// the newly required _STK_LIM / 4 * 3 maximum.\n\n// Complication: the rlimit is stored in a current-> structure that\n// is shared across the threads of the process.  They may concurrently\n// invoke this operation.\n\nfunction clamp_stack_rlim_cur:long ()\n%{\n  struct rlimit *rlim = current->signal->rlim;\n  unsigned long rlim_cur = READ_ONCE(rlim[RLIMIT_STACK].rlim_cur);\n\n  unsigned long limit = _STK_LIM / 4 * 3;\n  limit *= 4; // multiply it back up, to the scale used by rlim_cur\n\n  if (rlim_cur > limit) {\n    WRITE_ONCE(rlim[RLIMIT_STACK].rlim_cur, limit);\n    STAP_RETURN(limit);\n  } else\n    STAP_RETURN(0);\n%}\n\nprobe kernel.function(\"copy_strings\").call\n{\n  l = clamp_stack_rlim_cur()\n   if (l)\n     printf(\"lowered process %s(%d) STACK rlim_cur to %p\\n\",\n            execname(), pid(), l)\n}\n\nprobe begin {\n\tprintf(\"CVE-2018-14634 mitigation loaded\\n\")\n\n}\n\nprobe end {\n\tprintf(\"CVE-2018-14634 mitigation unloaded\\n\")\n}\n\n2) Install the \"systemtap\" package and any required dependencies. Refer\nto the \"2. Using SystemTap\" chapter in the Red Hat Enterprise Linux\n\"SystemTap Beginners Guide\" document, available from docs.redhat.com,\nfor information on installing the required -debuginfo and matching kernel-devel packages\n\n3) Run the \"stap -g [filename-from-step-1].stp\" command as root.\n\nIf the host is rebooted, the changes will be lost and the script must be\nrun again.\n\n\nAlternatively, build the systemtap script on a development system with\n\"stap -g -p 4 [filename-from-step-1].stp\", distribute the resulting\nkernel module to all affected systems, and run \"staprun -L <module>\" on those.\nWhen using this approach only systemtap-runtime package is required on\nthe affected systems. Please notice that the kernel version must be the same\nacross all systems.\n\n\nThis may not be a suitable workaround if your application uses massive amounts of stack space. Please consider this if there are any adverse affects when running this mitigation."
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Red Hat would like to thank Qualys Research Labs for reporting this issue."
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "LOCAL",
                "availabilityImpact": "HIGH",
                "baseScore": 7.8,
                "baseSeverity": "HIGH",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "LOW",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                "version": "3.0"
            }
        ]
    }
}