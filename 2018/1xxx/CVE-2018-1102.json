{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2018-1102",
        "ASSIGNER": "secalert@redhat.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A flaw was found in source-to-image function as shipped with Openshift Enterprise 3.x. An improper path validation of tar files in ExtractTarStreamFromTarReader in tar/tar.go leads to privilege escalation."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Improper Input Validation",
                        "cweId": "CWE-20"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Red Hat",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.2",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.2.1.34-2.git.3.aad33c3.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.3",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.3.1.46.39-2.git.3.cc57f5b.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.4",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.4.1.44.53-1.git.0.d7eb028.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:3.4.168-1.git.0.bb73aad.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:0.12.14-9.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.5",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.5.5.31.67-1.git.0.0a8cf24.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:3.5.165-1.git.0.475fa67.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.6",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.6.173.0.113-1.git.0.65fb9fb.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.5.3-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:0.60.0-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:0.13.1-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.9.23-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.0.1-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:0.0.9-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:5.10.3-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.2.2-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.13.1-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.3.1-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.2.5-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.2018.3-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:0.0.7.5-1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.7",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:1.0.6-1.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:3.7.44-1.git.0.6b061d4.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:1.14.0-1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.8",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.8.37-1.git.0.e85a326.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:3.8.37-1.git.224.8e15ecf.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:3.8.37-1.git.0.be319af.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.9",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.9.25-1.git.0.6bc473e.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat OpenShift Enterprise 3.1",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.1.1.11-4.git.3.12809c8.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:1.1.13-1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:1.1.13-1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:1.1.13-1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:1.1.13-1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1227",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1227"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1229",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1229"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1231",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1231"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1233",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1233"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1235",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1235"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1237",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1237"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1239",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1239"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1241",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1241"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2018:1243",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2018:1243"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2019:0036",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2019:0036"
            },
            {
                "url": "https://access.redhat.com/security/cve/CVE-2018-1102",
                "refsource": "MISC",
                "name": "https://access.redhat.com/security/cve/CVE-2018-1102"
            },
            {
                "url": "https://access.redhat.com/security/vulnerabilities/3422241",
                "refsource": "MISC",
                "name": "https://access.redhat.com/security/vulnerabilities/3422241"
            },
            {
                "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1562246",
                "refsource": "MISC",
                "name": "https://bugzilla.redhat.com/show_bug.cgi?id=1562246"
            }
        ]
    },
    "work_around": [
        {
            "lang": "en",
            "value": "Customers can turn off the source-to-image (S2I) build strategy to prevent access to the exploitable function.  Information about how to disable the source-to-image build strategy is in the product documentation.\n\n* Disabling S2I in OpenShift Enterprise 3.0 - https://docs.openshift.com/enterprise/3.0/admin_guide/securing_builds.html#disabling-a-build-strategy-globally\n* Disabling S2I in OpenShift Enterprise 3.1 - https://docs.openshift.com/enterprise/3.1/admin_guide/securing_builds.html#disabling-a-build-strategy-globally\n* Disabling S2I in OpenShift Enterprise 3.2 - https://docs.openshift.com/enterprise/3.2/admin_guide/securing_builds.html#disabling-a-build-strategy-globally\n* Disabling S2I in OpenShift Enterprise 3.3 - https://access.redhat.com/documentation/en-us/openshift_container_platform/3.3/html/cluster_administration/admin-guide-securing-builds\n* Disabling S2I in OpenShift Enterprise 3.4 - https://access.redhat.com/documentation/en-us/openshift_container_platform/3.4/html/cluster_administration/admin-guide-securing-builds\n* Disabling S2I in OpenShift Enterprise 3.5 - https://access.redhat.com/documentation/en-us/openshift_container_platform/3.5/html/cluster_administration/admin-guide-securing-builds\n* Disabling S2I in OpenShift Enterprise 3.6 - https://access.redhat.com/documentation/en-us/openshift_container_platform/3.6/html/cluster_administration/admin-guide-securing-builds\n* Disabling S2I in OpenShift Enterprise 3.7 - https://access.redhat.com/documentation/en-us/openshift_container_platform/3.7/html/cluster_administration/admin-guide-securing-builds\n* OpenShift Enterprise 3.8 is not a production version (only for upgrades).\n* Disabling S2I in OpenShift Enterprise 3.9 - https://access.redhat.com/documentation/en-us/openshift_container_platform/3.9/html/cluster_administration/admin-guide-securing-builds"
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Red Hat would like to thank Michael Hanselmann (hansmi.ch) for reporting this issue."
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 9.9,
                "baseSeverity": "CRITICAL",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "LOW",
                "scope": "CHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
                "version": "3.0"
            }
        ]
    }
}