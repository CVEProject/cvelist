{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2019-3876",
        "ASSIGNER": "secalert@redhat.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A flaw was found in the /oauth/token/request custom endpoint of the OpenShift OAuth server allowing for XSS generation of CLI tokens due to missing X-Frame-Options and CSRF protections. If not otherwise prevented, a separate XSS vulnerability via JavaScript could further allow for the extraction of these tokens."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Cross-Site Request Forgery (CSRF)",
                        "cweId": "CWE-352"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Red Hat",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Red Hat OpenShift Container Platform 3.11",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:3.11.129-1.git.0.bd4f2d5.el7",
                                            "version_affected": "!"
                                        },
                                        {
                                            "version_value": "0:3.11.1560870549-1.el7",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "http://www.securityfocus.com/bid/107664",
                "refsource": "MISC",
                "name": "http://www.securityfocus.com/bid/107664"
            },
            {
                "url": "https://access.redhat.com/errata/RHSA-2019:1851",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2019:1851"
            },
            {
                "url": "https://access.redhat.com/security/cve/CVE-2019-3876",
                "refsource": "MISC",
                "name": "https://access.redhat.com/security/cve/CVE-2019-3876"
            },
            {
                "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1691107",
                "refsource": "MISC",
                "name": "https://bugzilla.redhat.com/show_bug.cgi?id=1691107"
            },
            {
                "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3876",
                "refsource": "MISC",
                "name": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3876"
            }
        ]
    },
    "work_around": [
        {
            "lang": "en",
            "value": "Since at least v3.4, the OpenShift documentation [1] has specified the format for  corsAllowedOrigins to accurately match intended hostnames.  Since at least v3.7, installs will default to use the correct regular expression formatted variables.  Earlier versions may be configured with plain strings, a configuration which will persist across cluster upgrades, opening them to cross origin vulnerabilities such as this.\n\n\nAt a minimum, you should ensure that the corsAllowedOrigin definition within master-config.yaml contains elements in the form \n\n~~~\ncorsAllowedOrigins:\n- (?i)//my\\.subdomain\\.domain\\.com(:|\\z)\n~~~\n\nand not the form\n\n~~~\ncorsAllowedOrigins:\n- domain.com\n~~~\n\nas the first will permit cross origin requests only if the host matches exactly, whereas the second will permit from any host that merely contains the string (such as ABCDdomain.com or even domain.comABCD.com).\n\n\n\nFootnotes:\n\n[1] https://docs.openshift.com/container-platform/3.4/architecture/infrastructure_components/web_console.html#corsAllowedOrigins"
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "This issue was discovered by Mo Khan (Red Hat)."
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "HIGH",
                "attackVector": "NETWORK",
                "availabilityImpact": "LOW",
                "baseScore": 5,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "LOW",
                "integrityImpact": "LOW",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "REQUIRED",
                "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
                "version": "3.0"
            }
        ]
    }
}