{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2019-3899",
        "ASSIGNER": "secalert@redhat.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "It was found that the default configuration of Heketi does not require any authentication, potentially exposing the Heketi server API to be misused. An unauthenticated attacker could connect remotely to Heketi Server and run arbitrary commands supported by Heketi Server API via Heketi CLI."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Improper Authentication",
                        "cweId": "CWE-287"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Red Hat",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Native Client for RHEL 7 for Red Hat Storage",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:9.0.0-7.el7rhgs",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Red Hat Gluster Storage 3.5 for RHEL 7",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "0:9.0.0-7.el7rhgs",
                                            "version_affected": "!"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://access.redhat.com/errata/RHSA-2019:3255",
                "refsource": "MISC",
                "name": "https://access.redhat.com/errata/RHSA-2019:3255"
            },
            {
                "url": "https://access.redhat.com/security/cve/CVE-2019-3899",
                "refsource": "MISC",
                "name": "https://access.redhat.com/security/cve/CVE-2019-3899"
            },
            {
                "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1701091",
                "refsource": "MISC",
                "name": "https://bugzilla.redhat.com/show_bug.cgi?id=1701091"
            },
            {
                "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3899",
                "refsource": "MISC",
                "name": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3899"
            }
        ]
    },
    "work_around": [
        {
            "lang": "en",
            "value": "After installation of Heketi\n\n1. configure user and admin key in /etc/heketi/heketi.json file\n...\n{\n  \"_port_comment\": \"Heketi Server Port Number\",\n  \"port\": \"8080\",\n\n  \"_use_auth\": \"Enable JWT authorization. Please enable for deployment\",\n  \"use_auth\": true,\n\n  \"_jwt\": \"Private keys for access\",\n  \"jwt\": {\n    \"_admin\": \"Admin has access to all APIs\",\n    \"admin\": {\n      \"key\": \"My Secret\"\n    },\n    \"_user\": \"User only has access to /volumes endpoint\",\n    \"user\": {\n      \"key\": \"My Secret\"\n    }\n  },\n...\n\n2. restart heketi server"
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "This issue was discovered by Daniel Moessner (Red Hat)."
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "LOW",
                "baseScore": 7.3,
                "baseSeverity": "HIGH",
                "confidentialityImpact": "LOW",
                "integrityImpact": "LOW",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
                "version": "3.0"
            }
        ]
    }
}