{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2020-01-08T17:00:00.000Z",
        "ID": "CVE-2020-1603",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: Improper handling of specific IPv6 packets sent by clients eventually kernel crash (vmcore) the device."
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "16.1",
                                            "version_value": "16.1R7-S6"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "16.2",
                                            "version_value": "16.2R2-S11"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.1",
                                            "version_value": "17.1R2-S11, 17.1R3-S1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.2",
                                            "version_value": "17.2R1-S9, 17.2R2-S8, 17.2R3-S3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.3",
                                            "version_value": "17.3R3-S6"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2-S9, 17.4R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S7"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R3-S2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.2X75",
                                            "version_value": "18.2X75-D50, 18.2X75-D410"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R1-S6, 18.3R2-S2, 18.3R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R1-S6, 18.4R2-S2, 18.4R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R1-S3, 19.1R2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S2, 19.2R2"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "16.1",
                                            "version_value": "16.1X70-D10"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue may occur when an interface is configured with IPv6.\nFor example:  \n  [interfaces fe-1/2/0 unit 1 family inet6 address 2001:db8:0:1::/64] "
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "Specific IPv6 packets sent by clients processed by the Routing Engine (RE) are improperly handled. These IPv6 packets are designed to be blocked by the RE from egressing the RE. Instead, the RE allows these specific IPv6 packets to egress the RE, at which point a mbuf memory leak occurs within the Juniper Networks Junos OS device. This memory leak eventually leads to a kernel crash (vmcore), or the device hanging and requiring a power cycle to restore service, creating a Denial of Service (DoS) condition. During the time where mbufs are rising, yet not fully filled, some traffic from client devices may begin to be black holed. To be black holed, this traffic must match the condition where this traffic must be processed by the RE. Continued receipt and attempted egress of these specific IPv6 packets from the Routing Engine (RE) will create an extended Denial of Service (DoS) condition. Scenarios which have been observed are: 1. In a single chassis, single RE scenario, the device will hang without vmcore, or a vmcore may occur and then hang. In this scenario the device needs to be power cycled. 2. In a single chassis, dual RE scenario, the device master RE will fail over to the backup RE. In this scenario, the master and the backup REs need to be reset from time to time when they vmcore. There is no need to power cycle the device. 3. In a dual chassis, single RE scenario, the device will hang without vmcore, or a vmcore may occur and then hang. In this scenario, the two chassis' design relies upon some type of network level redundancy - VRRP, GRES, NSR, etc. - 3.a In a commanded switchover, where nonstop active routing (NSR) is enabled no session loss is observed. 4. In a dual chassis, dual chassis scenario, rely upon the RE to RE failover as stated in the second scenario. In the unlikely event that the device does not switch RE to RE gracefully, then the fallback position is to the network level services scenario in the third scenario. This issue affects: Juniper Networks Junos OS 16.1 versions prior to 16.1R7-S6; 16.1 version 16.1X70-D10 and later; 16.2 versions prior to 16.2R2-S11; 17.1 versions prior to 17.1R2-S11, 17.1R3-S1; 17.2 versions prior to 17.2R1-S9, 17.2R2-S8, 17.2R3-S3; 17.3 versions prior to 17.3R3-S6; 17.4 versions prior to 17.4R2-S9, 17.4R3; 18.1 versions prior to 18.1R3-S7; 18.2 versions prior to 18.2R3-S2; 18.2X75 versions prior to 18.2X75-D50, 18.2X75-D410; 18.3 versions prior to 18.3R1-S6, 18.3R2-S2, 18.3R3; 18.4 versions prior to 18.4R1-S6, 18.4R2-S2, 18.4R3; 19.1 versions prior to 19.1R1-S3, 19.1R2; 19.2 versions prior to 19.2R1-S2, 19.2R2. This issue does not affect releases prior to Junos OS 16.1R1."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 8.6,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "CHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-710 Improper Adherence to Coding Standards"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA10982",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA10982"
            },
            {
                "name": "https://prsearch.juniper.net/InfoCenter/index?page=prcontent&id=PR1443576",
                "refsource": "MISC",
                "url": "https://prsearch.juniper.net/InfoCenter/index?page=prcontent&id=PR1443576"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 16.1R7-S6, 16.2R2-S11, 17.1R2-S11, 17.1R3-S1, 17.2R1-S9, 17.2R2-S8, 17.2R3-S3, 17.3R3-S6, 17.4R2-S9, 17.4R3, 18.1R3-S7, 18.2R3-S2, 18.2X75-D50, 18.2X75-D410, 18.3R1-S6, 18.3R2-S2, 18.3R3, 18.4R1-S6, 18.4R2-S2, 18.4R3, 19.1R1-S3, 19.1R2, 19.2R1-S2, 19.2R2, 19.3R1, and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA10982",
        "defect": [
            "1443576"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "Remove 'family inet6' from interfaces. Otherwise, there are no available workarounds for this issue.\n\nIndicators of compromise can be found by reviewing RE logs for entries which match in \" \" :\n\"/kernel: Mbuf: High Utililization Level\"\n\nAdditionally, you may issue the follow command from time to time to determine if your mbufs are climbing or are being released by reviewing across two separate times.\n\nThe required privilege level to run the command is: view.\nshow system buffers"
        }
    ]
}