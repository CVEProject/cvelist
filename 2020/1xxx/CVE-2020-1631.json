{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2020-04-27T16:00:00.000Z",
        "ID": "CVE-2020-1631",
        "STATE": "PUBLIC",
        "TITLE": "Out of Cycle Security Advisory: Junos OS: Security vulnerability in J-Web and web based (HTTP/HTTPS) services"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "12.3",
                                            "version_value": "12.3R12-S16"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "12.3X48",
                                            "version_value": "12.3X48-D101, 12.3X48-D105"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "14.1X53",
                                            "version_value": "14.1X53-D54"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "15.1",
                                            "version_value": "15.1R7-S7"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "15.1X49",
                                            "version_value": "15.1X49-D211, 15.1X49-D220"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "16.1",
                                            "version_value": "16.1R7-S8"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.2",
                                            "version_value": "17.2R3-S4"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.3",
                                            "version_value": "17.3R3-S8"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2-S11, 17.4R3-S2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S10"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R2-S7, 18.2R3-S4"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R2-S4, 18.3R3-S2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R1-S7, 18.4R3-S2 "
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R1-S5, 19.1R3-S1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "19.1",
                                            "version_value": "19.1R2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S3, 19.3R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R1-S2, 19.4R2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R1-S1, 20.1R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "The examples of the config stanza affected by this issue:\n  [system services web-management http]\n  [system services web-management https]\n  [security dynamic-vpn]"
        }
    ],
    "credit": [
        {
            "lang": "eng",
            "value": "The Juniper SIRT would like to would like to acknowledge and thank Laing Bian and  Leishen Song (@rayh4c) of 360 ATA for reporting this issue."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A vulnerability in the HTTP/HTTPS service used by J-Web, Web Authentication, Dynamic-VPN (DVPN), Firewall Authentication Pass-Through with Web-Redirect, and Zero Touch Provisioning (ZTP) allows an unauthenticated attacker to perform local file inclusion (LFI) or path traversal. Using this vulnerability, an attacker may be able to inject commands into the httpd.log, read files with 'world' readable permission file or obtain J-Web session tokens. In the case of command injection, as the HTTP service runs as user 'nobody', the impact of this command injection is limited. (CVSS score 5.3, vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) In the case of reading files with 'world' readable permission, in Junos OS 19.3R1 and above, the unauthenticated attacker would be able to read the configuration file. (CVSS score 5.9, vector CVSS:3.1/ AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N) If J-Web is enabled, the attacker could gain the same level of access of anyone actively logged into J-Web. If an administrator is logged in, the attacker could gain administrator access to J-Web. (CVSS score 8.8, vector CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H) This issue only affects Juniper Networks Junos OS devices with HTTP/HTTPS services enabled. Junos OS devices with HTTP/HTTPS services disabled are not affected. If HTTP/HTTPS services are enabled, the following command will show the httpd processes: user@device> show system processes | match http 5260 - S 0:00.13 /usr/sbin/httpd-gk -N 5797 - I 0:00.10 /usr/sbin/httpd --config /jail/var/etc/httpd.conf To summarize: If HTTP/HTTPS services are disabled, there is no impact from this vulnerability. If HTTP/HTTPS services are enabled and J-Web is not in use, this vulnerability has a CVSS score of 5.9 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N). If J-Web is enabled, this vulnerability has a CVSS score of 8.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H). Juniper SIRT has received a single report of this vulnerability being exploited in the wild. Out of an abundance of caution, we are notifying customers so they can take appropriate actions. Indicators of Compromise: The /var/log/httpd.log may have indicators that commands have injected or files being accessed. The device administrator can look for these indicators by searching for the string patterns \"=*;*&\" or \"*%3b*&\" in /var/log/httpd.log, using the following command: user@device> show log httpd.log | match \"=*;*&|=*%3b*&\" If this command returns any output, it might be an indication of malicious attempts or simply scanning activities. Rotated logs should also be reviewed, using the following command: user@device> show log httpd.log.0.gz | match \"=*;*&|=*%3b*&\" user@device> show log httpd.log.1.gz | match \"=*;*&|=*%3b*&\" Note that a skilled attacker would likely remove these entries from the local log file, thus effectively eliminating any reliable signature that the device had been attacked. This issue affects Juniper Networks Junos OS 12.3 versions prior to 12.3R12-S16; 12.3X48 versions prior to 12.3X48-D101, 12.3X48-D105; 14.1X53 versions prior to 14.1X53-D54; 15.1 versions prior to 15.1R7-S7; 15.1X49 versions prior to 15.1X49-D211, 15.1X49-D220; 16.1 versions prior to 16.1R7-S8; 17.2 versions prior to 17.2R3-S4; 17.3 versions prior to 17.3R3-S8; 17.4 versions prior to 17.4R2-S11, 17.4R3-S2; 18.1 versions prior to 18.1R3-S10; 18.2 versions prior to 18.2R2-S7, 18.2R3-S4; 18.3 versions prior to 18.3R2-S4, 18.3R3-S2; 18.4 versions prior to 18.4R1-S7, 18.4R3-S2 ; 18.4 version 18.4R2 and later versions; 19.1 versions prior to 19.1R1-S5, 19.1R3-S1; 19.1 version 19.1R2 and later versions; 19.2 versions prior to 19.2R2; 19.3 versions prior to 19.3R2-S3, 19.3R3; 19.4 versions prior to 19.4R1-S2, 19.4R2; 20.1 versions prior to 20.1R1-S1, 20.1R2."
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "REQUIRED",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-73 External Control of File Name or Path"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11021",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11021"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 12.3R12-S16, 12.3X48-D101, 12.3X48-D105, 14.1X53-D54, 15.1X49-D211, 15.1X49-D220, 15.1R7-S7, 16.1R7-S8, 17.2R3-S4, 17.4R2-S11, 17.3R3-S8, 17.4R3-S2, 18.1R3-S10, 18.2R2-S7, 18.2R3-S4, 18.3R2-S4, 18.3R3-S2, 18.4R1-S7, 18.4R3-S2, 19.1R1-S5, 19.1R3-S1, 19.2R2, 19.3R2-S3, 19.3R3, 19.4R1-S2, 19.4R2, 20.1R1-S1, 20.1R2 and all subsequent releases.\n\nNote: At the time of this publication, the following fixed releases are available for customer download: 12.3X48-D101, 15.1X49-D211, 18.2R3-S4, 18.4R3-S2, and 20.1R1-S1, the remaining fixed releases will be available in future time.\n\n12.3X48-D101 & 15.1X49-D211 releases can be downloaded from the below URLs:\n\n12.3X48-D101 :\nBranch SRX-Series Install Package (for SRX100H2, SRX110HE2, SRX210H2, SRX220H2, SRX240H2, SRX550, SRX650): junos-srxsme-12.3X48-D101-domestic.tgz   \nhttps://webdownload.juniper.net/swdl/dl/secure/site/1/record/107438.html\n        MD5     = b822376f7a385e74499b186cf28c122b\n        SHA-1   = e6138e45bf9d29e962468e6e114e537142d4cc0d\n        SHA-256 = b21a9ae9f5d0b0ec25180682193faba7bf54e836fda0eb78babd3df843f90e6a\n \nSRX 1000/3000-Series Install Package : junos-srx1k3k-12.3X48-D101-domestic.tgz\nhttps://webdownload.juniper.net/swdl/dl/secure/site/1/record/107436.html\n        MD5     = b93229ea43f66b539f22ecc5a9be0f07\n        SHA-1   = 2c625e9bc155b9fcb4c9a1a371bba473363ee6f0\n        SHA-256 = 982434f9cde9492e1d80d14c43a7cdcc5261db15a11f65fa7c9881a0fc0cd3db\n \nSRX5000-Series Install Package: junos-srx5000-12.3X48-D101-domestic.tgz\nhttps://webdownload.juniper.net/swdl/dl/secure/site/1/record/107437.html\n        MD5     = 7dc73801b7680fda42d453d6d3d6f10c\n        SHA-1   = 05f1eda5ec112c7e2afeebea4d47c007e0a8bd60\n        SHA-256 = 88d40e4b6b949a5c656c2b5fffa3adb41fe4943fb3e5d9cfaa439e603889e839\n \n15.1X49-D211:\nSRX300 & SRX500-Series Install Package: junos-srxsme-15.1X49-D211-domestic.tgz\nhttps://webdownload.juniper.net/swdl/dl/secure/site/1/record/107439.html\n  MD5     = dfd3428c7f83eb11142bbe32bac2a151\n  SHA-1   = a22f0ead795c8afb0a4d59d1b9b785c83801cd65\n  SHA-256 = dc42e24db0e2af7b2e6aaafdaa61f8e658fabc91c8a888efad586a5fbd2fa29a\n \nSRX1500 Install Package: junos-srxentedge-15.1X49-D211-domestic.tgz \nhttps://webdownload.juniper.net/swdl/dl/secure/site/1/record/107442.html\n  MD5     = 348f2fcd96b31d51b9d71147d09fabd8\n  SHA-1   = cf8ee775ca1ca12706975fdd0748c1967732c2fe\n  SHA-256 = 62d460ea531161936f0ac75fa4501bc6cadb700388bdb93b7e706a09e985eff5\n \nSRX4100 and SRX4200 Install Package: junos-srxmr-15.1X49-D211-domestic.tgz\nhttps://webdownload.juniper.net/swdl/dl/secure/site/1/record/107441.html\n  MD5     = 55b4c96b05b5fd9595a8ee071dbbf438\n  SHA-1   = ae6d7978964c3be6b632033b3616208e47653617\n  SHA-256 = 20274c3b66d4b54471684a5f534abe0ba1d8bebabbb6f78f0028fcc275076df1\n \nSRX5000 Series Install Package: junos-srx5000-15.1X49-D211-domestic.tgz \nhttps://webdownload.juniper.net/swdl/dl/secure/site/1/record/107440.html\n  MD5     = b918fa5a341815ccdb230560539e8725\n  SHA-1   = 38e912a55f1407e18e1bb8305f854fcd97c1adcb\n  SHA-256 = c1aaafdd9b23a525236c414e4cf213542246326317070b5e98ac5cccc5fa1e72\n \nvSRX Upgrade TGZ: junos-vsrx-15.1X49-D211-domestic.tgz\nhttps://webdownload.juniper.net/swdl/dl/secure/site/1/record/107452.html\n  MD5     = 55b4c96b05b5fd9595a8ee071dbbf438\n  SHA-1   = ae6d7978964c3be6b632033b3616208e47653617\n  SHA-256 = 20274c3b66d4b54471684a5f534abe0ba1d8bebabbb6f78f0028fcc275076df1"
        }
    ],
    "source": {
        "advisory": "JSA11021",
        "defect": [
            "1499280"
        ],
        "discovery": "EXTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There are no viable workarounds for this issue.\n\nIt is highly recommended to disable HTTP/HTTPS service and DVPN:\n  user@device# deactivate system services web-management\n  user@device# deactivate security dynamic-vpn  (if DVPN is enabled)\n  user@device# commit\nor allowing HTTP service only on from trusted hosts or networks (refer to https://kb.juniper.net/KB21265 for details on how to limite HTTP service).\n\n\n"
        }
    ]
}