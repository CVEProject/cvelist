{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-04-14T16:00:00.000Z",
        "ID": "CVE-2021-0242",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: EX4300: FPC crash upon receipt of specific frames on an interface without L2PT or dot1x configured"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "17.3",
                                            "version_value": "17.3R3-S11"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2-S13, 17.4R3-S4"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S12"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R2-S8, 18.2R3-S7"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S4"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R1-S8, 18.4R2-S7, 18.4R3-S7"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R1-S6, 19.1R2-S2, 19.1R3-S4"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S6, 19.2R3-S2"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R3-S2"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R2-S3, 19.4R3-S1"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R2"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R2-S1, 20.2R3"
                                        },
                                        {
                                            "platform": "EX4300",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R1-S1, 20.3R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "No specific configuration is required on the EX4300."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A vulnerability due to the improper handling of direct memory access (DMA) buffers on EX4300 switches on Juniper Networks Junos OS allows an attacker sending specific unicast frames to trigger a Denial of Service (DoS) condition by exhausting DMA buffers, causing the FPC to crash and the device to restart. The DMA buffer leak is seen when receiving these specific, valid unicast frames on an interface without Layer 2 Protocol Tunneling (L2PT) or dot1x configured. Interfaces with either L2PT or dot1x configured are not vulnerable to this issue. When this issue occurs, DMA buffer usage keeps increasing and the following error log messages may be observed: Apr 14 14:29:34.360 /kernel: pid 64476 (pfex_junos), uid 0: exited on signal 11 (core dumped) Apr 14 14:29:33.790 init: pfe-manager (PID 64476) terminated by signal number 11. Core dumped! The DMA buffers on the FPC can be monitored by the executing vty command 'show heap': ID Base Total(b) Free(b) Used(b) % Name -- ---------- ----------- ----------- ----------- --- ----------- 0 4a46000 268435456 238230496 30204960 11 Kernel 1 18a46000 67108864 17618536 49490328 73 Bcm_sdk 2 23737000 117440512 18414552 99025960 84 DMA buf <<<<< keeps increasing 3 2a737000 16777216 16777216 0 0 DMA desc This issue affects Juniper Networks Junos OS on the EX4300: 17.3 versions prior to 17.3R3-S11; 17.4 versions prior to 17.4R2-S13, 17.4R3-S4; 18.1 versions prior to 18.1R3-S12; 18.2 versions prior to 18.2R2-S8, 18.2R3-S7; 18.3 versions prior to 18.3R3-S4; 18.4 versions prior to 18.4R1-S8, 18.4R2-S7, 18.4R3-S7; 19.1 versions prior to 19.1R1-S6, 19.1R2-S2, 19.1R3-S4; 19.2 versions prior to 19.2R1-S6, 19.2R3-S2; 19.3 versions prior to 19.3R3-S2; 19.4 versions prior to 19.4R2-S3, 19.4R3-S1; 20.1 versions prior to 20.1R2; 20.2 versions prior to 20.2R2-S1, 20.2R3; 20.3 versions prior to 20.3R1-S1, 20.3R2."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-119 Improper Restriction of Operations within the Bounds of a Memory Buffer"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-241 Improper Handling of Unexpected Data Type"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://kb.juniper.net/JSA11135",
                "name": "https://kb.juniper.net/JSA11135"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: Junos OS 17.3R3-S11, 17.4R2-S13, 17.4R3-S4, 18.1R3-S12, 18.2R2-S8, 18.2R3-S7, 18.3R3-S4, 18.4R1-S8, 18.4R2-S7, 18.4R3-S7, 19.1R1-S6, 19.1R2-S2, 19.1R3-S4, 19.2R1-S6, 19.2R3-S2, 19.3R3-S2, 19.4R2-S3, 19.4R3-S1, 20.1R2, 20.2R2-S1, 20.2R3, 20.3R1-S1, 20.3R2, 20.4R1, and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA11135",
        "defect": [
            "1545530"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There are no known workarounds for this issue."
        }
    ]
}