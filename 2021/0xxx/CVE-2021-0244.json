{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-04-14T16:00:00.000Z",
        "ID": "CVE-2021-0244",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: A race condition in the storm control profile may allow an attacker to cause a Denial of Service condition"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "EX Series",
                                            "version_affected": "<",
                                            "version_name": "14.1X53",
                                            "version_value": "14.1X53-D49"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "15.1",
                                            "version_value": "15.1R7-S6"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "15.1X49",
                                            "version_value": "15.1X49-D191, 15.1X49-D200"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "16.1",
                                            "version_value": "16.1R7-S7"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "16.2",
                                            "version_value": "16.2R2-S11, 16.2R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.1",
                                            "version_value": "17.1R2-S11, 17.1R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.2",
                                            "version_value": "17.2R2-S8, 17.2R3-S3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.3",
                                            "version_value": "17.3R2-S5, 17.3R3-S7"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2-S9, 17.4R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S5"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R2-S6, 18.2R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R1-S7, 18.3R2-S3, 18.3R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R1-S5, 18.4R2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R1-S4, 19.1R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "Devices configured with storm control may be impacted. To review if a device is configured with storm control, refer to the command structure under: \n  show storm_cntl profile \n\nExamples of of storm control configurations follow: \n\nFor Enhanced Layer 2 Software (ELS) release:\n\n  [interfaces <interface-name> unit 0 family ethernet-switching storm-control <profile-name>]\n\n(see https://www.juniper.net/documentation/en_US/junos/topics/task/configuration/rate-limiting-storm-control-disabling-cli-els.html for reference)\n\nFor non-ELS release:\n\n  [ethernet-switching-options storm-control interface <RGT_interface>]\nor\n  [ethernet-switching-options storm-control interface all]\n\n(see https://www.juniper.net/documentation/en_US/junos/topics/task/configuration/rate-limiting-storm-control-disabling-cli.html for reference)\n\nRefer to your specific product guides and the Junos OS Security Services Administration Guide for further information located at https://www.juniper.net/documentation/en_US/junos/information-products/pathway-pages/system-basics/security-services.html\n\n "
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A signal handler race condition exists in the Layer 2 Address Learning Daemon (L2ALD) of Juniper Networks Junos OS due to the absence of a specific protection mechanism to avoid a race condition which may allow an attacker to bypass the storm-control feature on devices. This issue is a corner case and only occurs during specific actions taken by an administrator of a device under certain specifics actions which triggers the event. The event occurs less frequently on devices which are not configured with Virtual Chassis configurations, and more frequently on devices configured in Virtual Chassis configurations. This issue is not specific to any particular Junos OS platform. An Indicator of Compromise (IoC) may be seen by reviewing log files for the following error message seen by executing the following show statement: show log messages | grep storm Result to look for: /kernel: GENCFG: op 58 (Storm Control Blob) failed; err 1 (Unknown) This issue affects: Juniper Networks Junos OS: 14.1X53 versions prior to 14.1X53-D49 on EX Series; 15.1 versions prior to 15.1R7-S6; 15.1X49 versions prior to 15.1X49-D191, 15.1X49-D200 on SRX Series; 16.1 versions prior to 16.1R7-S7; 16.2 versions prior to 16.2R2-S11, 16.2R3; 17.1 versions prior to 17.1R2-S11, 17.1R3; 17.2 versions prior to 17.2R2-S8, 17.2R3-S3; 17.3 versions prior to 17.3R2-S5, 17.3R3-S7; 17.4 versions prior to 17.4R2-S9, 17.4R3; 18.1 versions prior to 18.1R3-S5; 18.2 versions prior to 18.2R2-S6, 18.2R3; 18.3 versions prior to 18.3R1-S7, 18.3R2-S3, 18.3R3; 18.4 versions prior to 18.4R1-S5, 18.4R2; 19.1 versions prior to 19.1R1-S4, 19.1R2."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 7.4,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "CHANGED",
            "userInteraction": "REQUIRED",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "364 - Signal Handler Race Condition"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Absence of a specific protection mechanism to avoid a race condition. "
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://kb.juniper.net/JSA11137",
                "name": "https://kb.juniper.net/JSA11137"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 14.1X53-D49, 15.1R7-S6, 15.1X49-D191, 15.1X49-D200, 15.1X53-D592, 16.1R7-S7, 16.1R8, 16.2R2-S11, 16.2R3, 17.1R2-S11, 17.1R3, 17.2R2-S8, 17.2R3-S3, 17.3R2-S5, 17.3R3-S7, 17.4R2-S9, 17.4R3, 18.1R3-S5, 18.2R2-S6, 18.2R3, 18.3R1-S7, 18.3R2-S3, 18.3R3, 18.4R1-S5, 18.4R2, 19.1R1-S4, 19.1R2, 19.2R1, and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA11137",
        "defect": [
            "1403424"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There are no viable workarounds for this issue other than rebooting the device and monitoring for the Indicator of Compromise (IoC). Once the condition is cleared from the log files - the absence of the error message indicates the condition has cleared - the device is not exploitable to the situation, and the actions taken which lead to the IoC being present should not be taken again, until a fixed release can be applied. \n\n"
        }
    ]
}