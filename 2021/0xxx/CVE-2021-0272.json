{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-04-14T16:00:00.000Z",
        "ID": "CVE-2021-0272",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016: In EVPN-VXLAN scenarios receipt of specific genuine packets by an adjacent attacker will cause a kernel memory leak in FPC."
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "17.3",
                                            "version_value": "17.3R3-S9"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R3-S2"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S11"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R3-S5"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S3"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S5, 18.4R3-S4"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R3-S2"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R3"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R3"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R3"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R2"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": ">=",
                                            "version_name": "16.1",
                                            "version_value": "16.1R1"
                                        },
                                        {
                                            "platform": "QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016",
                                            "version_affected": "!<",
                                            "version_value": "16.1R1"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue occurs in composite next hop EVPN-VXLAN scenarios, chained-composite-next-hop (CHN) being configured is not a requirement but can still affect EVPN pure type 5 with VXLAN encapsulation deployments.\n\nSee https://kb.juniper.net/KB32854 for further configuration details.\n\n\n  # configure access links:\n  [interfaces <> unit 0 family ethernet-switching interface-mode trunk]\n  [interfaces <> unit 0 family ethernet-switching vlan-members <>]\n  ...\n  # configure the core link\n  [interfaces <> unit 0 family inet address <>]\n \n  # configure loopback address\n  [interfaces lo0 unit 0 family inet address <>]\n \n  # configure IRB\n  [interfaces irb unit 1 family inet address <>]\n \n  # evpn\n  [protocols evpn encapsulation vxlan]\n  [protocols evpn extended-vni-list <>]\n  [routing-options router-id <>]\n  [routing-options autonomous-system 100]\n \n  [protocols bgp group pe type internal]\n  [protocols bgp group pe local-address <>]\n  [protocols bgp group pe family evpn signaling]\n  [protocols bgp group pe neighbor <>]\n \n  [protocols ospf area 0.0.0.0 interface lo0 passive]\n  [protocols ospf area 0.0.0.0 interface <>]\n \n  [switch-options route-distinguisher <>]\n  [switch-options vrf-target target:1:1]\n  [switch-options vtep-source-interface lo0.0]\n \n  [vlans <> vlan-id <>]\n  [vlans <> vxlan vni <>]\n  [vlans <> l3-interface irb.1]\n \n \n\n\n"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A kernel memory leak in QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016 devices Flexible PIC Concentrators (FPCs) on Juniper Networks Junos OS allows an attacker to send genuine packets destined to the device to cause a Denial of Service (DoS) to the device. On QFX10002-32Q, QFX10002-60C, QFX10002-72Q devices the device will crash and restart. On QFX10008, QFX10016 devices, depending on the number of FPCs involved in an attack, one more more FPCs may crash and traffic through the device may be degraded in other ways, until the attack traffic stops. A reboot is required to restore service and clear the kernel memory. Continued receipt and processing of these genuine packets will create a sustained Denial of Service (DoS) condition. On QFX10008, QFX10016 devices, an indicator of compromise may be the existence of DCPFE core files. You can also monitor PFE memory utilization for incremental growth: user@qfx-RE:0% cprod -A fpc0 -c \"show heap 0\" | grep -i ke 0 3788a1b0 3221225048 2417120656 804104392 24 Kernel user@qfx-RE:0% cprod -A fpc0 -c \"show heap 0\" | grep -i ke 0 3788a1b0 3221225048 2332332200 888892848 27 Kernel This issue affects: Juniper Networks Junos OS on QFX10002-32Q, QFX10002-60C, QFX10002-72Q, QFX10008, QFX10016: 16.1 versions 16.1R1 and above prior to 17.3 versions prior to 17.3R3-S9; 17.4 versions prior to 17.4R3-S2; 18.1 versions prior to 18.1R3-S11; 18.2 versions prior to 18.2R3-S5; 18.3 versions prior to 18.3R3-S3; 18.4 versions prior to 18.4R2-S5, 18.4R3-S4; 19.1 versions prior to 19.1R3-S2; 19.2 versions prior to 19.2R3; 19.3 versions prior to 19.3R3; 19.4 versions prior to 19.4R3; 20.1 versions prior to 20.1R2. This issue does not affect releases prior to Junos OS 16.1R1. This issue does not affect EX Series devices. This issue does not affect Junos OS Evolved."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-401 Missing Release of Memory after Effective Lifetime"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://kb.juniper.net/JSA11163",
                "name": "https://kb.juniper.net/JSA11163"
            },
            {
                "refsource": "MISC",
                "url": "https://kb.juniper.net/KB32854",
                "name": "https://kb.juniper.net/KB32854"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 17.3R3-S9, 17.4R3-S2, 18.1R3-S11, 18.2R3-S5, 18.3R3-S3, 18.4R2-S5, 18.4R3-S4, 19.1R3-S2, 19.2R3, 19.3R3, 19.4R3, 20.1R2, 20.2R1, and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA11163",
        "defect": [
            "1486614"
        ],
        "discovery": "INTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There are no known workarounds for this issue."
        }
    ]
}