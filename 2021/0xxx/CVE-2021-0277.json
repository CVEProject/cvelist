{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-07-14T16:00:00.000Z",
        "ID": "CVE-2021-0277",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS and Junos OS Evolved: LLDP Out-of-Bounds Read vulnerability in l2cpd"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "12.3",
                                            "version_value": "12.3R12-S18"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "15.1",
                                            "version_value": "15.1R7-S9"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.3",
                                            "version_value": "17.3R3-S12"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2-S13, 17.4R3-S5"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S13"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R3-S8"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S5"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S8, 18.4R3-S8"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R3-S5"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R3-S3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S6, 19.3R3-S2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R1-S4, 19.4R2-S4, 19.4R3-S3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R2-S2, 20.1R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3-S1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R2-S1, 20.3R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R2"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS Evolved",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_value": "20.4R2-EVO"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This vulnerability is only exploitable on interfaces with LLDP enabled.  For example:\n\n  [protocols lldp]\n"
        }
    ],
    "credit": [
        {
            "lang": "eng",
            "value": "The Juniper SIRT would like to acknowledge and thank Qian Chen from the Codesafe Team of Legendsec at the Qi'anxin Group."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Out-of-bounds Read vulnerability in the processing of specially crafted LLDP frames by the Layer 2 Control Protocol Daemon (l2cpd) of Juniper Networks Junos OS and Junos OS Evolved may allow an attacker to cause a Denial of Service (DoS), or may lead to remote code execution (RCE). Continued receipt and processing of these frames, sent from the local broadcast domain, will repeatedly crash the l2cpd process and sustain the Denial of Service (DoS) condition. This issue affects: Juniper Networks Junos OS: 12.3 versions prior to 12.3R12-S18; 15.1 versions prior to 15.1R7-S9; 17.3 versions prior to 17.3R3-S12; 17.4 versions prior to 17.4R2-S13, 17.4R3-S5; 18.1 versions prior to 18.1R3-S13; 18.2 versions prior to 18.2R3-S8; 18.3 versions prior to 18.3R3-S5; 18.4 versions prior to 18.4R2-S8, 18.4R3-S8; 19.1 versions prior to 19.1R3-S5; 19.2 versions prior to 19.2R3-S3; 19.3 versions prior to 19.3R2-S6, 19.3R3-S2; 19.4 versions prior to 19.4R1-S4, 19.4R2-S4, 19.4R3-S3; 20.1 versions prior to 20.1R2-S2, 20.1R3; 20.2 versions prior to 20.2R3-S1; 20.3 versions prior to 20.3R2-S1, 20.3R3; 20.4 versions prior to 20.4R2. Juniper Networks Junos OS Evolved versions prior to 20.4R2-EVO."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-125 Out-of-bounds Read"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11181",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11181"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue:\n\nJunos OS 12.3R12-S18, 15.1R7-S9, 17.3R3-S12, 17.4R2-S13, 17.4R3-S5, 18.1R3-S13, 18.2R3-S8, 18.3R3-S5, 18.4R2-S8, 18.4R3-S8, 19.1R3-S5, 19.3R2-S6, 19.3R3-S2, 19.4R1-S4, 19.4R2-S4, 19.4R3-S3, 20.1R2-S2, 20.1R3, 20.2R3-S1, 20.3R2-S1, 20.3R3, 20.4R2, 20.4R3, 21.1R1, 21.1R2, 21.2R1, and all subsequent releases.\n\nJunos OS Evolved 20.4R2-EVO, 21.1R1-EVO, and all subsequent releases."
        }
    ],
    "source": {
        "advisory": "JSA11181",
        "defect": [
            "1569312"
        ],
        "discovery": "EXTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "1. Configure the device to not load the L2CPD daemon using the following CLI config stanza.\n\n  set system processes l2cpd-service disable\n\nAdditional protocols L2CPD daemon supports include RSTP, MSTP, VSTP, ERP, xSTP and ERP protocols. After issuing set system processes l2cpd-service disable, RSTP, MSTP, VSTP, ERP,  xSTP and ERP protocols will cease to operate.  Please note, this is not an exhaustive list, disabling L2CPD may affect other protocols and services that rely upon L2CPD daemon to be present.  For example, L2ALD, MRVP, EVPN traffic, etc. may also cease to operate. To avoid downtime, customers considering applying this workaround should carefully test all workaround changes to their environment in a non-production environment first that mirrors or as closely as possible matches the production environment before applying to the production environment.\n\n2. Configure target interfaces on the device to disable LLDP packet processing:\n \n  set protocols lldp interface <interface name> disable\n\n3. On Switching platforms such as EX/QFX Series devices implement packet filters to discard LLDP packets with an EtherType of 0x88cc.\n\nFor example:\n\n  set firewall family ethernet-switching filter LLDP_EXAMPLE term 1 from ether-type 0x88cc\n  set firewall family ethernet-switching filter LLDP_EXAMPLE term 1 then discard\n \nWorkaround #3 does not work on MX Series devices.  MX Series devices should disable LLDP processing, filter off-system, or upgrade to a fixed release.\n \n4. Lastly, as a method to reduce the risk of exploitation for this vulnerability, customers may implement off-system IDP and/or Firewall filtering methods such as disallowing LLDP EtherType to propagate completely on local segments, or by filtering broadcast addressed LLDP packets or unicast addressed LLDP packets not originated from trusted sources targeted to trusted destinations.\n\nAdditionally, it is good security practice to limit the exploitable attack surface of critical infrastructure networking equipment. Use access lists or firewall filters to limit access to the device via all means to only trusted, administrative networks, hosts and users.  \n"
        }
    ]
}