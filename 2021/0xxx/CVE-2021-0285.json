{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-07-14T16:00:00.000Z",
        "ID": "CVE-2021-0285",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: QFX5000 Series and EX4600 Series: Continuous traffic destined to a device configured with MC-LAG leading to nodes losing their control connection which can impact traffic"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "15.1",
                                            "version_value": "15.1R7-S9"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "17.3",
                                            "version_value": "17.3R3-S11"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2-S13, 17.4R3-S5"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S5"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S8, 18.4R3-S7"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R3-S5"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S6, 19.2R3-S2"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S6, 19.3R3-S2"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R1-S4, 19.4R2-S4, 19.4R3-S2"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R2-S2, 20.1R3"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R2-S3, 20.2R3"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R2"
                                        },
                                        {
                                            "platform": "QFX5000 Series and EX4600 Series",
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R1-S1, 20.4R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue only affects devices with ICCP configured:\n\n[ protocols iccp peer ]"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An uncontrolled resource consumption vulnerability in Juniper Networks Junos OS on QFX5000 Series and EX4600 Series switches allows an attacker sending large amounts of legitimate traffic destined to the device to cause Interchassis Control Protocol (ICCP) interruptions, leading to an unstable control connection between the Multi-Chassis Link Aggregation Group (MC-LAG) nodes which can in turn lead to traffic loss. Continued receipt of this amount of traffic will create a sustained Denial of Service (DoS) condition. An indication that the system could be impacted by this issue is the following log message: \"DDOS_PROTOCOL_VIOLATION_SET: Warning: Host-bound traffic for protocol/exception LOCALNH:aggregate exceeded its allowed bandwidth at fpc <fpc number> for <n> times, started at <timestamp>\" This issue affects Juniper Networks Junos OS on QFX5000 Series and EX4600 Series: 15.1 versions prior to 15.1R7-S9; 17.3 versions prior to 17.3R3-S11; 17.4 versions prior to 17.4R2-S13, 17.4R3-S5; 18.3 versions prior to 18.3R3-S5; 18.4 versions prior to 18.4R2-S8, 18.4R3-S7; 19.1 versions prior to 19.1R3-S5; 19.2 versions prior to 19.2R1-S6, 19.2R3-S2; 19.3 versions prior to 19.3R2-S6, 19.3R3-S2; 19.4 versions prior to 19.4R1-S4, 19.4R2-S4, 19.4R3-S2; 20.1 versions prior to 20.1R2-S2, 20.1R3; 20.2 versions prior to 20.2R2-S3, 20.2R3; 20.3 versions prior to 20.3R2; 20.4 versions prior to 20.4R1-S1, 20.4R2."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-770 Allocation of Resources Without Limits or Throttling"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11187",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11187"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 15.1R7-S9, 17.3R3-S11, 17.4R2-S13, 17.4R3-S5, 18.1R3-S13, 18.2R3-S8, 18.3R3-S5, 18.4R2-S8, 18.4R3-S7, 19.1R3-S5, 19.2R1-S6, 19.2R3-S2, 19.3R2-S6, 19.3R3-S2, 19.4R1-S4, 19.4R2-S4, 19.4R3-S2, 20.1R2-S2, 20.1R3, 20.2R2-S3, 20.2R3, 20.3R2, 20.4R1-S1, 20.4R2, 21.1R1, and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA11187",
        "defect": [
            "1552877"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "While no complete workaround exists, the risk of malicious exploitation can be reduced by filtering undesirable traffic using firewall filters and policers, or increase the bandwidth for the localnh DDOS queue."
        }
    ]
}