{
    "CVE_data_meta": {
        "ASSIGNER": "security-officer@isc.org",
        "DATE_PUBLIC": "2021-04-28T20:20:10.000Z",
        "ID": "CVE-2021-25216",
        "STATE": "PUBLIC",
        "TITLE": "A second vulnerability in BIND's GSSAPI security policy negotiation can be targeted by a buffer overflow attack"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "BIND9",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_name": "Open Source Branches 9.5 though 9.11",
                                            "version_value": "9.5.0 through versions before 9.11.31"
                                        },
                                        {
                                            "version_name": "Open Source Branches 9.12 though 9.16",
                                            "version_value": "9.12.0 through versions before 9.16.14"
                                        },
                                        {
                                            "version_name": "Supported Preview Branch 9.11-S",
                                            "version_value": "9.11.3-S1 through versions before 9.11.31-S1"
                                        },
                                        {
                                            "version_name": "Supported Preview Branch 9.16-S",
                                            "version_value": "9.16.8-S1 through versions before 9.16.14-S1"
                                        },
                                        {
                                            "version_name": "Development Branch 9.17",
                                            "version_value": "9.17.0 through versions before 9.17.2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "ISC"
                }
            ]
        }
    },
    "credit": [
        {
            "lang": "eng",
            "value": " ISC would like to thank an anonymous party, working in conjunction with Trend Micro Zero Day Initiative, for reporting this issue to us."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "In BIND 9.5.0 -> 9.11.29, 9.12.0 -> 9.16.13, and versions BIND 9.11.3-S1 -> 9.11.29-S1 and 9.16.8-S1 -> 9.16.13-S1 of BIND Supported Preview Edition, as well as release versions 9.17.0 -> 9.17.1 of the BIND 9.17 development branch, BIND servers are vulnerable if they are running an affected version and are configured to use GSS-TSIG features. In a configuration which uses BIND's default settings the vulnerable code path is not exposed, but a server can be rendered vulnerable by explicitly setting values for the tkey-gssapi-keytab or tkey-gssapi-credential configuration options. Although the default configuration is not vulnerable, GSS-TSIG is frequently used in networks where BIND is integrated with Samba, as well as in mixed-server environments that combine BIND servers with Active Directory domain controllers. For servers that meet these conditions, the ISC SPNEGO implementation is vulnerable to various attacks, depending on the CPU architecture for which BIND was built: For named binaries compiled for 64-bit platforms, this flaw can be used to trigger a buffer over-read, leading to a server crash. For named binaries compiled for 32-bit platforms, this flaw can be used to trigger a server crash due to a buffer overflow and possibly also to achieve remote code execution. We have determined that standard SPNEGO implementations are available in the MIT and Heimdal Kerberos libraries, which support a broad range of operating systems, rendering the ISC implementation unnecessary and obsolete. Therefore, to reduce the attack surface for BIND users, we will be removing the ISC SPNEGO implementation in the April releases of BIND 9.11 and 9.16 (it had already been dropped from BIND 9.17). We would not normally remove something from a stable ESV (Extended Support Version) of BIND, but since system libraries can replace the ISC SPNEGO implementation, we have made an exception in this case for reasons of stability and security."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "We are not aware of any active exploits."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 8.1,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "GSS-TSIG is an extension to the TSIG protocol which is intended to support the secure exchange of keys for use in verifying the authenticity of communications between parties on a network.  SPNEGO is a negotiation mechanism used by GSSAPI, the application protocol interface for GSS-TSIG.  The SPNEGO implementation used by BIND has been found to be vulnerable to a buffer overflow attack.  Affects BIND 9.5.0 -> 9.11.29, 9.12.0 -> 9.16.13, and versions BIND 9.11.3-S1 -> 9.11.29-S1 and 9.16.8-S1 -> 9.16.13-S1 of BIND Supported Preview Edition, as well as release versions 9.17.0 -> 9.17.1 of the BIND 9.17 development branch."
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.isc.org/v1/docs/cve-2021-25215",
                "refsource": "CONFIRM",
                "url": "https://kb.isc.org/v1/docs/cve-2021-25215"
            },
            {
                "refsource": "MLIST",
                "name": "[oss-security] 20210428 ISC discloses three BIND vulnerabilities (CVE-2021-25214, CVE-2021-25215, and CVE-2021-25216)",
                "url": "http://www.openwall.com/lists/oss-security/2021/04/29/1"
            },
            {
                "refsource": "MLIST",
                "name": "[oss-security] 20210429 Re: ISC discloses three BIND vulnerabilities (CVE-2021-25214, CVE-2021-25215, and CVE-2021-25216)",
                "url": "http://www.openwall.com/lists/oss-security/2021/04/29/2"
            },
            {
                "refsource": "MLIST",
                "name": "[oss-security] 20210429 Re: ISC discloses three BIND vulnerabilities (CVE-2021-25214, CVE-2021-25215, and CVE-2021-25216)",
                "url": "http://www.openwall.com/lists/oss-security/2021/04/29/3"
            },
            {
                "refsource": "MLIST",
                "name": "[oss-security] 20210429 Re: ISC discloses three BIND vulnerabilities (CVE-2021-25214, CVE-2021-25215, and CVE-2021-25216)",
                "url": "http://www.openwall.com/lists/oss-security/2021/04/29/4"
            },
            {
                "refsource": "DEBIAN",
                "name": "DSA-4909",
                "url": "https://www.debian.org/security/2021/dsa-4909"
            },
            {
                "refsource": "MLIST",
                "name": "[debian-lts-announce] 20210504 [SECURITY] [DLA 2647-1] bind9 security update",
                "url": "https://lists.debian.org/debian-lts-announce/2021/05/msg00001.html"
            },
            {
                "refsource": "CONFIRM",
                "name": "https://security.netapp.com/advisory/ntap-20210521-0006/",
                "url": "https://security.netapp.com/advisory/ntap-20210521-0006/"
            },
            {
                "refsource": "MISC",
                "name": "https://www.zerodayinitiative.com/advisories/ZDI-21-657/",
                "url": "https://www.zerodayinitiative.com/advisories/ZDI-21-657/"
            },
            {
                "refsource": "CONFIRM",
                "name": "https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf",
                "url": "https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "Upgrade to the patched release most closely related to your current version of BIND:\n\n    BIND 9.11.31\n    BIND 9.16.15\n    BIND 9.17.12\n\nBIND Supported Preview Edition is a special feature preview branch of BIND provided to eligible ISC support customers.\n\n    BIND 9.11.31-S1\n    BIND 9.16.15-S1"
        }
    ],
    "source": {
        "discovery": "EXTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "This vulnerability only affects servers configured to use GSS-TSIG, most often to sign dynamic updates. If another mechanism can be used to authenticate updates, the vulnerability can be avoided by choosing not to enable the use of GSS-TSIG features.\n\nPrior to the April 2021 BIND releases, on some platforms it was possible to build a working BIND installation that was not vulnerable to CVE-2021-25216 by providing the --disable-isc-spnego command-line argument when running the ./configure script in the top level of the BIND source directory, before compiling and linking named.\n\nAfter the April 2021 BIND releases, all supported branches have removed isc-spnego support. This corrects CVE-2021-25216, but requires that the system have other libraries and header files to support GSS-TSIG functionality, unless such functionality is completely disabled at build time by providing the --without-gssapi argument to the ./configurescript when selecting build options."
        }
    ]
}