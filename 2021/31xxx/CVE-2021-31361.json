{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-10-13T16:00:00.000Z",
        "ID": "CVE-2021-31361",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: QFX Series and PTX Series: FPC resource usage increases when certain packets are processed which are being VXLAN encapsulated"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_value": "17.3R3-S11"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2-S13, 17.4R3-S4"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S12"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R2-S8, 18.2R3-S7"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S4"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R1-S8, 18.4R2-S7, 18.4R3-S7"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R1-S6, 19.1R2-S2, 19.1R3-S4"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S6, 19.2R3-S2"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R3-S1"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R2-S3, 19.4R3-S1"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R2, 20.1R3"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R2, 20.2R3"
                                        },
                                        {
                                            "platform": " QFX Series",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R1-S1, 20.3R2"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_value": "18.4R3-S9"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R3-S6"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S7, 19.2R3-S3"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S6, 19.3R3-S3"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R1-S4, 19.4R3-S5"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R2-S2, 20.1R3"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3-S1"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R2-S1, 20.3R3"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R2-S1, 20.4R3"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "21.1",
                                            "version_value": "21.1R1-S1, 21.1R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "An minimal example VXLAN configuration affected would be:\n\n  set bridge-domains vlan-20 vxlan vni 10\n  set bridge-domains vlan-20 vlan-id 10\n  set bridge-domains vlan-20 interface xe-1/0/1.0\n  set interfaces xe-1/0/1 vlan-tagging\n  set interfaces xe-1/0/1 encapsulation flexible-ethernet-services\n  set interfaces xe-1/0/1 unit 0 encapsulation vlan-bridge\n  set interfaces xe-1/0/1 unit 0 vlan-id 10"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Improper Check for Unusual or Exceptional Conditions vulnerability combined with Improper Handling of Exceptional Conditions in Juniper Networks Junos OS on QFX Series and PTX Series allows an unauthenticated network based attacker to cause increased FPC CPU utilization by sending specific IP packets which are being VXLAN encapsulated leading to a partial Denial of Service (DoS). Continued receipted of these specific traffic will create a sustained Denial of Service (DoS) condition. This issue affects: Juniper Networks Junos OS on QFX Series: All versions prior to 17.3R3-S11; 17.4 versions prior to 17.4R2-S13, 17.4R3-S4; 18.1 versions prior to 18.1R3-S12; 18.2 versions prior to 18.2R2-S8, 18.2R3-S7; 18.3 versions prior to 18.3R3-S4; 18.4 versions prior to 18.4R1-S8, 18.4R2-S7, 18.4R3-S7; 19.1 versions prior to 19.1R1-S6, 19.1R2-S2, 19.1R3-S4; 19.2 versions prior to 19.2R1-S6, 19.2R3-S2; 19.3 versions prior to 19.3R3-S1; 19.4 versions prior to 19.4R2-S3, 19.4R3-S1; 20.1 versions prior to 20.1R2, 20.1R3; 20.2 versions prior to 20.2R2, 20.2R3; 20.3 versions prior to 20.3R1-S1, 20.3R2. Juniper Networks Junos OS on PTX Series: All versions prior to 18.4R3-S9; 19.1 versions prior to 19.1R3-S6; 19.2 versions prior to 19.2R1-S7, 19.2R3-S3; 19.3 versions prior to 19.3R2-S6, 19.3R3-S3; 19.4 versions prior to 19.4R1-S4, 19.4R3-S5; 20.1 versions prior to 20.1R2-S2, 20.1R3; 20.2 versions prior to 20.2R3-S1; 20.3 versions prior to 20.3R2-S1, 20.3R3; 20.4 versions prior to 20.4R2-S1, 20.4R3; 21.1 versions prior to 21.1R1-S1, 21.1R2."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "LOW",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-754 Improper Check for Unusual or Exceptional Conditions"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-755 Improper Handling of Exceptional Conditions"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11223",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11223"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue for QFX Series: 17.3R3-S11, 17.4R2-S13, 17.4R3-S4, 18.1R3-S12, 18.2R2-S8, 18.2R3-S7, 18.3R3-S4, 18.4R1-S8, 18.4R2-S7, 18.4R3-S7, 19.1R1-S6, 19.1R2-S2, 19.1R3-S4, 19.2R1-S6, 19.2R3-S2, 19.3R3-S1, 19.4R2-S3, 19.4R3-S1, 20.1R2, 20.1R3, 20.2R2, 20.2R3, 20.3R1-S1, 20.3R2, 20.4R1, and all subsequent releases.\n\nThe following software releases have been updated to resolve this specific issue for PTX Series: 18.4R3-S9, 19.1R3-S6, 19.2R1-S7, 19.2R3-S3, 19.3R2-S6, 19.3R3-S3, 19.4R1-S4, 19.4R3-S5, 20.1R2-S2, 20.1R3, 20.2R3-S1, 20.3R2-S1, 20.3R3, 20.4R2-S1, 20.4R3, 21.1R1-S1, 21.1R2, 21.2R1, and all subsequent releases."
        }
    ],
    "source": {
        "advisory": "JSA11223",
        "defect": [
            "1490063",
            "1584197"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There are no viable workarounds for this issue."
        }
    ]
}