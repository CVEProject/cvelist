{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-10-13T16:00:00.000Z",
        "ID": "CVE-2021-31364",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: SRX Series: The flowd process will crash if log session-close is configured and specific traffic is received"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_value": "17.4R3-S5"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S5"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R3-S9"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R3-S6"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S7, 19.2R3-S2"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S6, 19.3R3-S2"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R1-S4, 19.4R3-S3"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R2-S2, 20.1R3"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R2-S1, 20.3R3"
                                        },
                                        {
                                            "platform": "SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2",
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue can only occur when logging for session-close is configured similar to the following example:\n\n  [security policies from-zone untrust to-zone trust policy policy_name then log session-close]\n"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Improper Check for Unusual or Exceptional Conditions vulnerability combined with a Race Condition in the flow daemon (flowd) of Juniper Networks Junos OS on SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2 allows an unauthenticated network based attacker sending specific traffic to cause a crash of the flowd/srxpfe process, responsible for traffic forwarding in SRX, which will cause a Denial of Service (DoS). Continued receipt and processing of this specific traffic will create a sustained Denial of Service (DoS) condition. This issue can only occur when specific packets are trying to create the same session and logging for session-close is configured as a policy action. Affected platforms are: SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2. Not affected platforms are: SRX4000 Series, SRX5000 Series with SPC3, and vSRX Series. This issue affects Juniper Networks Junos OS SRX300 Series, SRX500 Series, SRX1500, and SRX5000 Series with SPC2: All versions prior to 17.4R3-S5; 18.3 versions prior to 18.3R3-S5; 18.4 versions prior to 18.4R3-S9; 19.1 versions prior to 19.1R3-S6; 19.2 versions prior to 19.2R1-S7, 19.2R3-S2; 19.3 versions prior to 19.3R2-S6, 19.3R3-S2; 19.4 versions prior to 19.4R1-S4, 19.4R3-S3; 20.1 versions prior to 20.1R2-S2, 20.1R3; 20.2 versions prior to 20.2R3; 20.3 versions prior to 20.3R2-S1, 20.3R3; 20.4 versions prior to 20.4R2."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-754 Improper Check for Unusual or Exceptional Conditions"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-362 Race Condition (Concurrent Execution using Shared Resource with Improper Synchronization)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11226",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11226"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 17.4R3-S5, 18.3R3-S5, 18.4R3-S9, 19.1R3-S6, 19.2R1-S7, 19.2R3-S2, 19.3R2-S6, 19.3R3-S2, 19.4R1-S4, 19.4R3-S3, 20.1R2-S2, 20.1R3, 20.2R3, 20.3R2-S1, 20.3R3, 20.4R2, 21.1R1, and all subsequent releases."
        }
    ],
    "source": {
        "advisory": "JSA11226",
        "defect": [
            "1571354"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "Please remove the session-close log action from the policy actions of all policies."
        }
    ]
}