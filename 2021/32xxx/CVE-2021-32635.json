{
  "data_type": "CVE",
  "data_format": "MITRE",
  "data_version": "4.0",
  "CVE_data_meta": {
    "ID": "CVE-2021-32635",
    "ASSIGNER": "security-advisories@github.com",
    "TITLE": "Action Commands (run/shell/exec) Against Library URIs Ignore Configured Remote Endpoint",
    "STATE": "PUBLIC"
  },
  "source": {
    "advisory": "GHSA-5mv9-q7fq-9394",
    "discovery": "UNKNOWN"
  },
  "affects": {
    "vendor": {
      "vendor_data": [
        {
          "vendor_name": "sylabs",
          "product": {
            "product_data": [
              {
                "product_name": "singularity",
                "version": {
                  "version_data": [
                    {
                      "version_name": "",
                      "version_affected": "",
                      "version_value": ">= 3.7.2, <= 3.7.3",
                      "platform": ""
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  },
  "problemtype": {
    "problemtype_data": [
      {
        "description": [
          {
            "lang": "eng",
            "value": "CWE-923: Improper Restriction of Communication Channel to Intended Endpoints"
          }
        ]
      },
      {
        "description": [
          {
            "lang": "eng",
            "value": "CWE-20 Improper Input Validation"
          }
        ]
      }
    ]
  },
  "description": {
    "description_data": [
      {
        "lang": "eng",
        "value": "### Impact\n\nDue to incorrect use of a default URL, `singularity` action commands (`run`/`shell`/`exec`) specifying a container using a `library://` URI will always attempt to retrieve the container from the default remote endpoint (`cloud.sylabs.io`) rather than the configured remote endpoint.\n\nAn attacker may be able to push a malicious container to the default remote endpoint with a URI that is identical to the URI used by a victim with a non-default remote endpoint, thus executing the malicious container.\n\nOnly action commands (`run`/`shell`/`exec`) against `library://` URIs are affected. Other commands such as `pull` / `push` respect the configured remote endpoint.\n\n### Patches\n\nAll users should upgrade to Singularity 3.7.4 or later.\n\n### Workarounds\n\nUsers who only interact with the default remote endpoint are not affected.\n\nInstallations with an execution control list configured to restrict execution to containers signed with specific secure keys are not affected.\n\n### For more information\n\nGeneral questions about the impact of the advisory can be asked in the:\n\n- [SingularityCE Slack Channel](https://singularityce.slack.com)\n- [SingularityCE Mailing List](https://groups.google.com/g/singularity-ce)\n\nAny sensitive security concerns should be directed to: security@sylabs.io\n\nSee our Security Policy here: https://sylabs.io/security-policy"
      }
    ]
  },
  "references": {
    "reference_data": [
      {
        "refsource": "CONFIRM",
        "url": "https://github.com/sylabs/singularity/security/advisories/GHSA-5mv9-q7fq-9394",
        "name": "https://github.com/sylabs/singularity/security/advisories/GHSA-5mv9-q7fq-9394"
      }
    ]
  },
  "impact": {
    "cvss": {
      "version": "3.1",
      "attackVector": "NETWORK",
      "attackComplexity": "LOW",
      "privilegesRequired": "NONE",
      "userInteraction": "REQUIRED",
      "scope": "UNCHANGED",
      "confidentialityImpact": "LOW",
      "integrityImpact": "LOW",
      "availabilityImpact": "LOW",
      "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
      "baseScore": 6.3,
      "baseSeverity": "MEDIUM"
    }
  }
}
