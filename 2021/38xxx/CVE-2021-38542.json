{
    "CVE_data_meta": {
        "ASSIGNER": "security@apache.org",
        "ID": "CVE-2021-38542",
        "STATE": "PUBLIC",
        "TITLE": "Apache James vulnerable to STARTTLS command injection (IMAP and POP3)"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Apache James",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "Apache James",
                                            "version_value": "3.6.1"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Apache Software Foundation"
                }
            ]
        }
    },
    "credit": [
        {
            "lang": "eng",
            "value": "We thanks Benoit Tellier, Raphael Ouazana for reporting this vulnerability as well as Damian Poddebniak, Fabian Ising, Hanno B\u00f6ck, and Sebastian Schinzel M\u00fcnster University of Applied Science for their research and tools regarding STARTTLS security."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "Apache James prior to release 3.6.1 is vulnerable to a buffering attack relying on the use of the STARTTLS command. This can result in Man-in -the-middle command injection attacks, leading potentially to leakage of sensible information."
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": [
        {
            "other": "moderate"
        }
    ],
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-77 Improper Neutralization of Special Elements used in a Command ('Command Injection')"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://www.openwall.com/lists/oss-security/2022/01/04/1",
                "name": "https://www.openwall.com/lists/oss-security/2022/01/04/1"
            },
            {
                "refsource": "MLIST",
                "name": "[oss-security] 20220104 CVE-2021-38542: Apache James vulnerable to STARTTLS command injection (IMAP and POP3)",
                "url": "http://www.openwall.com/lists/oss-security/2022/01/04/1"
            },
            {
                "refsource": "MLIST",
                "name": "[oss-security] 20220919 CVE-2022-28220: STARTTLS command injection in Apache JAMES",
                "url": "http://www.openwall.com/lists/oss-security/2022/09/20/1"
            }
        ]
    },
    "source": {
        "defect": [
            "JAMES-1862"
        ],
        "discovery": "UNKNOWN"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "We recommend to upgrade to Apache James 3.6.1, which fixes this vulnerability.\n\nFurthermore, we recommend, if possible to dis-activate STARTTLS and rely solely on explicit TLS for mail protocols, including SMTP, IMAP and POP3."
        }
    ]
}