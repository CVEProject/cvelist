{
    "CVE_data_meta": {
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "DATE_PUBLIC": "2021-06-22T16:00:00.000Z",
        "ID": "CVE-2021-3044",
        "STATE": "PUBLIC",
        "TITLE": "Cortex XSOAR: Unauthorized Usage of the REST API"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Cortex XSOAR",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "!",
                                            "version_name": "5.5.0",
                                            "version_value": "all"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "6.0.0",
                                            "version_value": "all"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "6.1.0",
                                            "version_value": "1016923"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "6.1.0",
                                            "version_value": "1271064"
                                        },
                                        {
                                            "version_affected": "!<",
                                            "version_name": "6.1.0",
                                            "version_value": "1016923"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "6.1.0",
                                            "version_value": "1271064"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "6.2.0",
                                            "version_value": "1271065"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "6.2.0",
                                            "version_value": "1271065"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "6.0.1",
                                            "version_value": "all"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "6.0.2",
                                            "version_value": "all"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Palo Alto Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue is applicable only to Cortex XSOAR configurations with active API key integrations.\n\nYou can determine whether your configuration is impacted by selecting \u2018Settings > Integration > API Keys\u2019 from the Cortex XSOAR web client."
        }
    ],
    "credit": [
        {
            "lang": "eng",
            "value": "This issue was found during internal security review."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An improper authorization vulnerability in Palo Alto Networks Cortex XSOAR enables a remote unauthenticated attacker with network access to the Cortex XSOAR server to perform unauthorized actions through the REST API. This issue impacts: Cortex XSOAR 6.1.0 builds later than 1016923 and earlier than 1271064; Cortex XSOAR 6.2.0 builds earlier than 1271065. This issue does not impact Cortex XSOAR 5.5.0, Cortex XSOAR 6.0.0, Cortex XSOAR 6.0.1, or Cortex XSOAR 6.0.2 versions. All Cortex XSOAR instances hosted by Palo Alto Networks are upgraded to resolve this vulnerability. No additional action is required for these instances."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Palo Alto Networks is not aware of any malicious attempts to exploit this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-285 Improper Authorization"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://security.paloaltonetworks.com/CVE-2021-3044",
                "name": "https://security.paloaltonetworks.com/CVE-2021-3044"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "This issue is fixed in Cortex XSOAR 6.1.0 build 1271064, Cortex XSOAR 6.2.0 build 1271065, and all later Cortex XSOAR versions."
        }
    ],
    "source": {
        "discovery": "INTERNAL"
    },
    "timeline": [
        {
            "lang": "eng",
            "time": "2021-06-22T16:00:00.000Z",
            "value": "Initial publication"
        }
    ],
    "work_around": [
        {
            "lang": "eng",
            "value": "You must revoke all active integration API keys to fully mitigate the impact of this issue.\n\nTo revoke integration API keys from the Cortex XSOAR web client:\nSettings > Integration > API Keys  and then Revoke each API key.\n\nYou can create new API keys after you upgrade Cortex XSOAR to a fixed version."
        },
        {
            "lang": "eng",
            "value": "Restricting network access to the Cortex XSOAR server to allow only trusted users also reduces the impact of this issue."
        }
    ]
}