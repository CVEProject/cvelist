{
    "CVE_data_meta": {
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "DATE_PUBLIC": "2021-11-10T17:00:00.000Z",
        "ID": "CVE-2021-3060",
        "STATE": "PUBLIC",
        "TITLE": "PAN-OS: OS Command Injection in Simple Certificate Enrollment Protocol (SCEP)"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "PAN-OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "8.1",
                                            "version_value": "8.1.20-h1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "9.0",
                                            "version_value": "9.0.14-h3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "9.1",
                                            "version_value": "9.1.11-h2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "10.0",
                                            "version_value": "10.0.8"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "10.1",
                                            "version_value": "10.1.3"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "8.1",
                                            "version_value": "8.1.20-h1"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "9.0",
                                            "version_value": "9.0.14-h3"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "9.1",
                                            "version_value": "9.1.11-h2"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "10.0",
                                            "version_value": "10.0.8"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "10.1",
                                            "version_value": "10.1.3"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Prisma Access",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_name": "2.1",
                                            "version_value": "Preferred"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "2.2",
                                            "version_value": "all"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_name": "2.1",
                                            "version_value": "Innovation"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Palo Alto Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue is applicable only to GlobalProtect portal and gateway configurations that are configured with a SCEP profile and when the default master key was not changed.\n\nYou can determine if your configuration has a SCEP profile by selecting 'Device > Certificate Management > SCEP' from the web interface.\n\nNote: The SCEP profile does not need to be enabled for the firewall to be at risk; it need only exist in the configuration to be a risk even if disabled.\n\nYou know you are using the default master key when the master key was not explicitly configured on the firewall. Review the master key configuration by selecting 'Device > Master Key and Diagnostics' from the web interface and change the key if needed.\n"
        }
    ],
    "credit": [
        {
            "lang": "eng",
            "value": "Palo Alto Networks thanks CJ, an external security researcher, for discovering and reporting this issue."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An OS command injection vulnerability in the Simple Certificate Enrollment Protocol (SCEP) feature of PAN-OS software allows an unauthenticated network-based attacker with specific knowledge of the firewall configuration to execute arbitrary code with root user privileges. The attacker must have network access to the GlobalProtect interfaces to exploit this issue. This issue impacts: PAN-OS 8.1 versions earlier than PAN-OS 8.1.20-h1; PAN-OS 9.0 versions earlier than PAN-OS 9.0.14-h3; PAN-OS 9.1 versions earlier than PAN-OS 9.1.11-h2; PAN-OS 10.0 versions earlier than PAN-OS 10.0.8; PAN-OS 10.1 versions earlier than PAN-OS 10.1.3. Prisma Access customers with Prisma Access 2.1 Preferred and Prisma Access 2.1 Innovation firewalls are impacted by this issue."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Palo Alto Networks is not aware of any malicious exploitation of this issue at time of publication. However, we expect exploits for this issue to become publicly available."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 8.1,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-78 OS Command Injection"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://security.paloaltonetworks.com/CVE-2021-3060",
                "name": "https://security.paloaltonetworks.com/CVE-2021-3060"
            },
            {
                "refsource": "MISC",
                "url": "https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/certificate-management/configure-the-master-key.html",
                "name": "https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/certificate-management/configure-the-master-key.html"
            },
            {
                "refsource": "MISC",
                "url": "https://docs.paloaltonetworks.com/prisma/prisma-access/innovation/2-1/prisma-access-panorama-admin/prepare-the-prisma-access-infrastructure/get-started-with-prisma-access-overview.html",
                "name": "https://docs.paloaltonetworks.com/prisma/prisma-access/innovation/2-1/prisma-access-panorama-admin/prepare-the-prisma-access-infrastructure/get-started-with-prisma-access-overview.html"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "This issue is fixed in PAN-OS 8.1.20-h1, PAN-OS 9.0.14-h3, PAN-OS 9.1.11-h2, PAN-OS 10.0.8, PAN-OS 10.1.3, and all later PAN-OS versions."
        },
        {
            "lang": "eng",
            "value": "This issue is fixed in Prisma Access 2.2 Preferred and all later Prisma Access versions."
        }
    ],
    "source": {
        "defect": [
            "PAN-176661"
        ],
        "discovery": "EXTERNAL"
    },
    "timeline": [
        {
            "lang": "eng",
            "time": "2021-11-10T17:00:00.000Z",
            "value": "Initial publication"
        }
    ],
    "work_around": [
        {
            "lang": "eng",
            "value": "Changing the master key for the firewall prevents exploitation of this vulnerability. This is a security best practice for both PAN-OS and Prisma Access customers.\n\nDocumentation for configuring the master key is available at: https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/certificate-management/configure-the-master-key.html. Please note the special requirements for high-availability (HA) and Panorama-managed environments.\n\nAdditional information is available for Prisma Access customers at: https://docs.paloaltonetworks.com/prisma/prisma-access/innovation/2-1/prisma-access-panorama-admin/prepare-the-prisma-access-infrastructure/get-started-with-prisma-access-overview.html.\n\nRemove all configured SCEP profiles from the firewall to completely eliminate any risk of exploitation related to this issue. You can view any existing SCEP profiles configured on the firewall by selecting 'Device > Certificate Management > SCEP' from the web interface.\n\nThis issue requires the attacker to have network access to the GlobalProtect interface.\n\nIn addition to these workarounds, you should enable signatures for Unique Threat ID 91526 on traffic destined for GlobalProtect interfaces to further mitigate the risk of attacks against CVE-2021-3060. SSL decryption is not necessary to detect attacks against this issue."
        }
    ],
    "x_advisoryEoL": false,
    "x_affectedList": [
        "Prisma Access 2.1",
        "PAN-OS 10.1.2",
        "PAN-OS 10.1.1",
        "PAN-OS 10.1.0",
        "PAN-OS 10.1",
        "PAN-OS 10.0.7",
        "PAN-OS 10.0.6",
        "PAN-OS 10.0.5",
        "PAN-OS 10.0.4",
        "PAN-OS 10.0.3",
        "PAN-OS 10.0.2",
        "PAN-OS 10.0.1",
        "PAN-OS 10.0.0",
        "PAN-OS 10.0",
        "PAN-OS 9.1.11-h1",
        "PAN-OS 9.1.11",
        "PAN-OS 9.1.10",
        "PAN-OS 9.1.9",
        "PAN-OS 9.1.8",
        "PAN-OS 9.1.7",
        "PAN-OS 9.1.6",
        "PAN-OS 9.1.5",
        "PAN-OS 9.1.4",
        "PAN-OS 9.1.3-h1",
        "PAN-OS 9.1.3",
        "PAN-OS 9.1.2-h1",
        "PAN-OS 9.1.2",
        "PAN-OS 9.1.1",
        "PAN-OS 9.1.0-h3",
        "PAN-OS 9.1.0-h2",
        "PAN-OS 9.1.0-h1",
        "PAN-OS 9.1.0",
        "PAN-OS 9.1",
        "PAN-OS 9.0.14-h2",
        "PAN-OS 9.0.14-h1",
        "PAN-OS 9.0.14",
        "PAN-OS 9.0.13",
        "PAN-OS 9.0.12",
        "PAN-OS 9.0.11",
        "PAN-OS 9.0.10",
        "PAN-OS 9.0.9-h1",
        "PAN-OS 9.0.9",
        "PAN-OS 9.0.8",
        "PAN-OS 9.0.7",
        "PAN-OS 9.0.6",
        "PAN-OS 9.0.5",
        "PAN-OS 9.0.4",
        "PAN-OS 9.0.3-h3",
        "PAN-OS 9.0.3-h2",
        "PAN-OS 9.0.3-h1",
        "PAN-OS 9.0.3",
        "PAN-OS 9.0.2-h4",
        "PAN-OS 9.0.2-h3",
        "PAN-OS 9.0.2-h2",
        "PAN-OS 9.0.2-h1",
        "PAN-OS 9.0.2",
        "PAN-OS 9.0.1",
        "PAN-OS 9.0.0",
        "PAN-OS 9.0",
        "PAN-OS 8.1.20",
        "PAN-OS 8.1.19",
        "PAN-OS 8.1.18",
        "PAN-OS 8.1.17",
        "PAN-OS 8.1.16",
        "PAN-OS 8.1.15-h3",
        "PAN-OS 8.1.15-h2",
        "PAN-OS 8.1.15-h1",
        "PAN-OS 8.1.15",
        "PAN-OS 8.1.14-h2",
        "PAN-OS 8.1.14-h1",
        "PAN-OS 8.1.14",
        "PAN-OS 8.1.13",
        "PAN-OS 8.1.12",
        "PAN-OS 8.1.11",
        "PAN-OS 8.1.10",
        "PAN-OS 8.1.9-h4",
        "PAN-OS 8.1.9-h3",
        "PAN-OS 8.1.9-h2",
        "PAN-OS 8.1.9-h1",
        "PAN-OS 8.1.9",
        "PAN-OS 8.1.8-h5",
        "PAN-OS 8.1.8-h4",
        "PAN-OS 8.1.8-h3",
        "PAN-OS 8.1.8-h2",
        "PAN-OS 8.1.8-h1",
        "PAN-OS 8.1.8",
        "PAN-OS 8.1.7",
        "PAN-OS 8.1.6-h2",
        "PAN-OS 8.1.6-h1",
        "PAN-OS 8.1.6",
        "PAN-OS 8.1.5",
        "PAN-OS 8.1.4",
        "PAN-OS 8.1.3",
        "PAN-OS 8.1.2",
        "PAN-OS 8.1.1",
        "PAN-OS 8.1.0",
        "PAN-OS 8.1"
    ],
    "x_likelyAffectedList": [
        "PAN-OS 8.0.20",
        "PAN-OS 8.0.19-h1",
        "PAN-OS 8.0.19",
        "PAN-OS 8.0.18",
        "PAN-OS 8.0.17",
        "PAN-OS 8.0.16",
        "PAN-OS 8.0.15",
        "PAN-OS 8.0.14",
        "PAN-OS 8.0.13",
        "PAN-OS 8.0.12",
        "PAN-OS 8.0.11-h1",
        "PAN-OS 8.0.10",
        "PAN-OS 8.0.9",
        "PAN-OS 8.0.8",
        "PAN-OS 8.0.7",
        "PAN-OS 8.0.6-h3",
        "PAN-OS 8.0.6-h2",
        "PAN-OS 8.0.6-h1",
        "PAN-OS 8.0.6",
        "PAN-OS 8.0.5",
        "PAN-OS 8.0.4",
        "PAN-OS 8.0.3-h4",
        "PAN-OS 8.0.3-h3",
        "PAN-OS 8.0.3-h2",
        "PAN-OS 8.0.3-h1",
        "PAN-OS 8.0.3",
        "PAN-OS 8.0.2",
        "PAN-OS 8.0.1",
        "PAN-OS 8.0.0",
        "PAN-OS 8.0",
        "PAN-OS 7.1.26",
        "PAN-OS 7.1.25",
        "PAN-OS 7.1.24-h1",
        "PAN-OS 7.1.24",
        "PAN-OS 7.1.23",
        "PAN-OS 7.1.22",
        "PAN-OS 7.1.21",
        "PAN-OS 7.1.20",
        "PAN-OS 7.1.19",
        "PAN-OS 7.1.18",
        "PAN-OS 7.1.17",
        "PAN-OS 7.1.16",
        "PAN-OS 7.1.15",
        "PAN-OS 7.1.14",
        "PAN-OS 7.1.13",
        "PAN-OS 7.1.12",
        "PAN-OS 7.1.11",
        "PAN-OS 7.1.10",
        "PAN-OS 7.1.9-h4",
        "PAN-OS 7.1.9-h3",
        "PAN-OS 7.1.9-h2",
        "PAN-OS 7.1.9-h1",
        "PAN-OS 7.1.9",
        "PAN-OS 7.1.8",
        "PAN-OS 7.1.7",
        "PAN-OS 7.1.6",
        "PAN-OS 7.1.5",
        "PAN-OS 7.1.4-h2",
        "PAN-OS 7.1.4-h1",
        "PAN-OS 7.1.4",
        "PAN-OS 7.1.3",
        "PAN-OS 7.1.2",
        "PAN-OS 7.1.1",
        "PAN-OS 7.1.0",
        "PAN-OS 7.1"
    ]
}