{
    "CVE_data_meta": {
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "DATE_PUBLIC": "2022-03-09T17:00:00.000Z",
        "ID": "CVE-2022-0022",
        "STATE": "PUBLIC",
        "TITLE": "PAN-OS: Use of a Weak Cryptographic Algorithm for Stored Password Hashes"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "PAN-OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "9.1",
                                            "version_value": "9.1.11"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "8.1",
                                            "version_value": "8.1.21"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "10.0",
                                            "version_value": "10.0.7"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "9.1",
                                            "version_value": "9.1.11"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "8.1",
                                            "version_value": "8.1.21"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "10.0",
                                            "version_value": "10.0.7"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "10.1",
                                            "version_value": "10.1.*"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_name": "9.0",
                                            "version_value": "9.0.*"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "10.2",
                                            "version_value": "10.2.*"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Prisma Access",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "!",
                                            "version_name": "3.0",
                                            "version_value": "Preferred, Innovation"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "2.2",
                                            "version_value": "Preferred"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "2.1",
                                            "version_value": "Preferred, Innovation"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Palo Alto Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue is applicable only to PAN-OS firewalls and Panorama appliances running in normal (non-FIPS-CC) operational mode. PAN-OS software is not affected by this issue when running in FIPS-CC mode."
        }
    ],
    "credit": [
        {
            "lang": "eng",
            "value": "Palo Alto Networks thanks an external security researcher for discovering and reporting this issue."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "Usage of a weak cryptographic algorithm in Palo Alto Networks PAN-OS software where the password hashes of administrator and local user accounts are not created with a sufficient level of computational effort, which allows for password cracking attacks on accounts in normal (non-FIPS-CC) operational mode. An attacker must have access to the account password hashes to take advantage of this weakness and can acquire those hashes if they are able to gain access to the PAN-OS software configuration. Fixed versions of PAN-OS software use a secure cryptographic algorithm for account password hashes. This issue does not impact Prisma Access firewalls. This issue impacts: PAN-OS 8.1 versions earlier than PAN-OS 8.1.21; All versions of PAN-OS 9.0; PAN-OS 9.1 versions earlier than PAN-OS 9.1.11; PAN-OS 10.0 versions earlier than PAN-OS 10.0.7."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Palo Alto Networks is not aware of any malicious exploitation of this issue."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "LOCAL",
            "availabilityImpact": "NONE",
            "baseScore": 4.1,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "privilegesRequired": "HIGH",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-916 Use of Password Hash With Insufficient Computational Effort"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://security.paloaltonetworks.com/CVE-2022-0022",
                "name": "https://security.paloaltonetworks.com/CVE-2022-0022"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "This issue is fixed in PAN-OS 8.1.21, PAN-OS 9.1.11, PAN-OS 10.0.7, and all later PAN-OS versions.\n\nThe passwords for all existing local user and administrator accounts must be changed after PAN-OS is upgraded to a fixed version to leverage the more secure cryptography for password hashes. You cannot update existing password hashes. All new local user and administrator accounts will use secure cryptography.\n\nPAN-OS 9.0 is end-of-life as of March 1, 2022, and is no longer covered by our Product Security Assurance policies.\n"
        }
    ],
    "source": {
        "defect": [
            "PAN-127479"
        ],
        "discovery": "EXTERNAL"
    },
    "timeline": [
        {
            "lang": "eng",
            "time": "2022-03-09T16:00:00.000Z",
            "value": "Initial publication"
        }
    ],
    "work_around": [
        {
            "lang": "eng",
            "value": "Ensure that any exported firewall configuration files are secured and that only trusted users have firewall management access to prevent the exposure of password hashes.\nUsing complex and secure passwords for all administrator and local user accounts makes password cracking infeasible and mitigates the impact of this issue.\n \nSwitching PAN-OS software from normal mode to FIPS-CC mode ensures that appliances use secure cryptography to store hashed credentials for all local user accounts. However, when you enable FIPS-CC mode, the appliance will reset to the factory default settings and the existing configuration is removed.\n\nDocumentation to enable FIPS-CC mode is available here:\nhttps://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/certifications/enable-fips-and-common-criteria-support.html\n"
        }
    ],
    "x_advisoryEoL": false,
    "x_affectedList": [
        "PAN-OS 10.0.6",
        "PAN-OS 10.0.5",
        "PAN-OS 10.0.4",
        "PAN-OS 10.0.3",
        "PAN-OS 10.0.2",
        "PAN-OS 10.0.1",
        "PAN-OS 10.0.0",
        "PAN-OS 10.0",
        "PAN-OS 9.1.10",
        "PAN-OS 9.1.9",
        "PAN-OS 9.1.8",
        "PAN-OS 9.1.7",
        "PAN-OS 9.1.6",
        "PAN-OS 9.1.5",
        "PAN-OS 9.1.4",
        "PAN-OS 9.1.3-h1",
        "PAN-OS 9.1.3",
        "PAN-OS 9.1.2-h1",
        "PAN-OS 9.1.2",
        "PAN-OS 9.1.1",
        "PAN-OS 9.1.0-h3",
        "PAN-OS 9.1.0-h2",
        "PAN-OS 9.1.0-h1",
        "PAN-OS 9.1.0",
        "PAN-OS 9.1",
        "PAN-OS 9.0.16",
        "PAN-OS 9.0.15",
        "PAN-OS 9.0.14-h4",
        "PAN-OS 9.0.14-h3",
        "PAN-OS 9.0.14-h2",
        "PAN-OS 9.0.14-h1",
        "PAN-OS 9.0.14",
        "PAN-OS 9.0.13",
        "PAN-OS 9.0.12",
        "PAN-OS 9.0.11",
        "PAN-OS 9.0.10",
        "PAN-OS 9.0.9-h1",
        "PAN-OS 9.0.9",
        "PAN-OS 9.0.8",
        "PAN-OS 9.0.7",
        "PAN-OS 9.0.6",
        "PAN-OS 9.0.5",
        "PAN-OS 9.0.4",
        "PAN-OS 9.0.3-h3",
        "PAN-OS 9.0.3-h2",
        "PAN-OS 9.0.3-h1",
        "PAN-OS 9.0.3",
        "PAN-OS 9.0.2-h4",
        "PAN-OS 9.0.2-h3",
        "PAN-OS 9.0.2-h2",
        "PAN-OS 9.0.2-h1",
        "PAN-OS 9.0.2",
        "PAN-OS 9.0.1",
        "PAN-OS 9.0.0",
        "PAN-OS 9.0",
        "PAN-OS 8.1.20-h1",
        "PAN-OS 8.1.20",
        "PAN-OS 8.1.19",
        "PAN-OS 8.1.18",
        "PAN-OS 8.1.17",
        "PAN-OS 8.1.16",
        "PAN-OS 8.1.15-h3",
        "PAN-OS 8.1.15-h2",
        "PAN-OS 8.1.15-h1",
        "PAN-OS 8.1.15",
        "PAN-OS 8.1.14-h2",
        "PAN-OS 8.1.14-h1",
        "PAN-OS 8.1.14",
        "PAN-OS 8.1.13",
        "PAN-OS 8.1.12",
        "PAN-OS 8.1.11",
        "PAN-OS 8.1.10",
        "PAN-OS 8.1.9-h4",
        "PAN-OS 8.1.9-h3",
        "PAN-OS 8.1.9-h2",
        "PAN-OS 8.1.9-h1",
        "PAN-OS 8.1.9",
        "PAN-OS 8.1.8-h5",
        "PAN-OS 8.1.8-h4",
        "PAN-OS 8.1.8-h3",
        "PAN-OS 8.1.8-h2",
        "PAN-OS 8.1.8-h1",
        "PAN-OS 8.1.8",
        "PAN-OS 8.1.7",
        "PAN-OS 8.1.6-h2",
        "PAN-OS 8.1.6-h1",
        "PAN-OS 8.1.6",
        "PAN-OS 8.1.5",
        "PAN-OS 8.1.4",
        "PAN-OS 8.1.3",
        "PAN-OS 8.1.2",
        "PAN-OS 8.1.1",
        "PAN-OS 8.1.0",
        "PAN-OS 8.1"
    ],
    "x_likelyAffectedList": [
        "PAN-OS 8.0.20",
        "PAN-OS 8.0.19-h1",
        "PAN-OS 8.0.19",
        "PAN-OS 8.0.18",
        "PAN-OS 8.0.17",
        "PAN-OS 8.0.16",
        "PAN-OS 8.0.15",
        "PAN-OS 8.0.14",
        "PAN-OS 8.0.13",
        "PAN-OS 8.0.12",
        "PAN-OS 8.0.11-h1",
        "PAN-OS 8.0.10",
        "PAN-OS 8.0.9",
        "PAN-OS 8.0.8",
        "PAN-OS 8.0.7",
        "PAN-OS 8.0.6-h3",
        "PAN-OS 8.0.6-h2",
        "PAN-OS 8.0.6-h1",
        "PAN-OS 8.0.6",
        "PAN-OS 8.0.5",
        "PAN-OS 8.0.4",
        "PAN-OS 8.0.3-h4",
        "PAN-OS 8.0.3-h3",
        "PAN-OS 8.0.3-h2",
        "PAN-OS 8.0.3-h1",
        "PAN-OS 8.0.3",
        "PAN-OS 8.0.2",
        "PAN-OS 8.0.1",
        "PAN-OS 8.0.0",
        "PAN-OS 8.0",
        "PAN-OS 7.1.26",
        "PAN-OS 7.1.25",
        "PAN-OS 7.1.24-h1",
        "PAN-OS 7.1.24",
        "PAN-OS 7.1.23",
        "PAN-OS 7.1.22",
        "PAN-OS 7.1.21",
        "PAN-OS 7.1.20",
        "PAN-OS 7.1.19",
        "PAN-OS 7.1.18",
        "PAN-OS 7.1.17",
        "PAN-OS 7.1.16",
        "PAN-OS 7.1.15",
        "PAN-OS 7.1.14",
        "PAN-OS 7.1.13",
        "PAN-OS 7.1.12",
        "PAN-OS 7.1.11",
        "PAN-OS 7.1.10",
        "PAN-OS 7.1.9-h4",
        "PAN-OS 7.1.9-h3",
        "PAN-OS 7.1.9-h2",
        "PAN-OS 7.1.9-h1",
        "PAN-OS 7.1.9",
        "PAN-OS 7.1.8",
        "PAN-OS 7.1.7",
        "PAN-OS 7.1.6",
        "PAN-OS 7.1.5",
        "PAN-OS 7.1.4-h2",
        "PAN-OS 7.1.4-h1",
        "PAN-OS 7.1.4",
        "PAN-OS 7.1.3",
        "PAN-OS 7.1.2",
        "PAN-OS 7.1.1",
        "PAN-OS 7.1.0",
        "PAN-OS 7.1"
    ]
}