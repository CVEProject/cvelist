{
    "CVE_data_meta": {
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "DATE_PUBLIC": "2022-08-10T16:00:00.000Z",
        "ID": "CVE-2022-0028",
        "STATE": "PUBLIC",
        "TITLE": "PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Cloud NGFW",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "!",
                                            "version_value": "All"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "PAN-OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "8.1",
                                            "version_value": "8.1.23-h1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "9.0",
                                            "version_value": "9.0.16-h3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "9.1",
                                            "version_value": "9.1.14-h4"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "10.0",
                                            "version_value": "10.0.11-h1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "10.1",
                                            "version_value": "10.1.6-h6"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "10.2",
                                            "version_value": "10.2.2-h2"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "8.1",
                                            "version_value": "8.1.23-h1"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "9.0",
                                            "version_value": "9.0.16-h3"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "9.1",
                                            "version_value": "9.1.14-h4"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "10.0",
                                            "version_value": "10.0.11-h1"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "10.1",
                                            "version_value": "10.1.6-h6"
                                        },
                                        {
                                            "version_affected": "!>=",
                                            "version_name": "10.2",
                                            "version_value": "10.2.2-h2"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Prisma Access",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "!",
                                            "version_name": "2.1",
                                            "version_value": "All"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "2.2",
                                            "version_value": "All"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "3.0",
                                            "version_value": "All"
                                        },
                                        {
                                            "version_affected": "!",
                                            "version_name": "3.1",
                                            "version_value": "All"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Palo Alto Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "The firewall configuration must have a URL filtering profile with one or more blocked categories assigned to a source zone that has an external facing interface for this issue to be misused by an external attacker. This configuration is not typical for URL filtering and is likely unintended by the administrator.\n\nThis issue is applicable to PA-Series (hardware), VM-Series (virtual), and CN-Series (container) firewalls only when all three of the following conditions are true:\n\n1. The security policy on the firewall that allows traffic to pass from Zone A to Zone B includes a URL filtering profile with one or more blocked categories;\nAND\n2. Packet-based attack protection is not enabled in a Zone Protection profile for Zone A including both (Packet Based Attack Protection > TCP Drop > TCP Syn With Data) and (Packet Based Attack Protection > TCP Drop > Strip TCP Options > TCP Fast Open);\nAND\n3. Flood protection through SYN cookies is not enabled in a Zone Protection profile for Zone A (Flood Protection > SYN > Action > SYN Cookie) with an activation threshold of 0 connections."
        }
    ],
    "credit": [
        {
            "lang": "eng",
            "value": "Palo Alto Networks thanks CERT-XLM for reporting this issue."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A PAN-OS URL filtering policy misconfiguration could allow a network-based attacker to conduct reflected and amplified TCP denial-of-service (RDoS) attacks. The DoS attack would appear to originate from a Palo Alto Networks PA-Series (hardware), VM-Series (virtual) and CN-Series (container) firewall against an attacker-specified target. To be misused by an external attacker, the firewall configuration must have a URL filtering profile with one or more blocked categories assigned to a source zone that has an external facing interface. This configuration is not typical for URL filtering and, if set, is likely unintended by the administrator. If exploited, this issue would not impact the confidentiality, integrity, or availability of our products. However, the resulting denial-of-service (DoS) attack may help obfuscate the identity of the attacker and implicate the firewall as the source of the attack. We have taken prompt action to address this issue in our PAN-OS software. All software updates for this issue are expected to be released no later than the week of August 15, 2022. This issue does not impact Panorama M-Series or Panorama virtual appliances. This issue has been resolved for all Cloud NGFW and Prisma Access customers and no additional action is required from them."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Palo Alto Networks recently learned that an attempted reflected denial-of-service (RDoS) attack was identified by a service provider. This attempted attack took advantage of susceptible firewalls from multiple vendors, including Palo Alto Networks. We immediately started to root cause and remediate this issue.\n\nExploitation of this issue does not impact the confidentiality, integrity, or availability of our products.\n"
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 8.6,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "CHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-406 Insufficient Control of Network Message Volume (Network Amplification)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://security.paloaltonetworks.com/CVE-2022-0028",
                "name": "https://security.paloaltonetworks.com/CVE-2022-0028"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "We identified workarounds to prevent the denial-of-service (DoS) attacks that result from this issue in certain Palo Alto Networks firewalls, with this policy configuration\n\nWe intend to fix this issue for PA-Series, VM-Series and CN-Series firewalls with a fix in the following PAN-OS software releases: PAN-OS 8.1.23-h1 (ETA: week of August 8, 2022), PAN-OS 9.0.16-h3 (ETA: week of August 15, 2022), PAN-OS 9.1.14-h4 (ETA: week of August 15, 2022), PAN-OS 10.0.11-h1 (ETA: week of August 15, 2022), PAN-OS 10.1.6-h6 (ETA: week of August 8, 2022), and PAN-OS 10.2.2-h2 (ETA: week of August 15, 2022).\n\nWe expect to release all PAN-OS software updates for this issue no later than the week of August 15, 2022."
        }
    ],
    "source": {
        "defect": [
            "PAN-192999"
        ],
        "discovery": "EXTERNAL"
    },
    "timeline": [
        {
            "lang": "eng",
            "time": "2022-08-10T16:00:00.000Z",
            "value": "Initial publication"
        }
    ],
    "work_around": [
        {
            "lang": "eng",
            "value": "If you have a URL filtering policy with one or more blocked categories assigned to a source zone that has an external facing network interface, removing this configuration will prevent this issue from being exploited by remote attackers to conduct reflected DoS.\n\nTo prevent denial-of-service (DoS) attacks resulting from this issue from all sources, you can configure your Palo Alto Networks firewalls by enabling one of two zone protection mitigations on all Security zones with an assigned Security policy that includes a URL filtering profile:\n\n1. Packet-based attack protection including both (Packet Based Attack Protection > TCP Drop > TCP SYN with Data) and (Packet Based Attack Protection > TCP Drop > Strip TCP Options > TCP Fast Open);\nOR\n2. Flood protection (Flood Protection > SYN > Action > SYN Cookie) with an activation threshold of 0 connections.\n\nNOTES:\n1. It is not necessary nor advantageous to apply both the attack and flood protections. \n2. (Palo Alto Networks Aporeto software only) You should not enable either of these protections if using Aporeto software; instead, wait for and install a fixed version of PAN-OS software.\n\nPacket-Based Attack Protection Workaround (Recommended)\n\nFollow the technical documentation to configure packet-based attack protection options for all defined Security zones with URL filtering enabled in the Security profile for that zone:\nhttps://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/configure-zone-protection-to-increase-network-security/configure-packet-based-attack-protection\n\nThe packet-based attack protection workaround will prevent the firewall from establishing TCP sessions in impacted zones when the TCP SYN packet contains data in the three-way handshake for a TCP session. Please note that this workaround may disrupt applications that use TCP Fast Open in the zone.\n\nFlood Protection (Alternate) Workaround\n\nIf you instead decide to enable the flood protection workaround, first make sure you understand how  enabling SYN cookies will change traffic flow in the impacted zones:\nhttps://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/zone-defense/zone-protection-profiles/flood-protection"
        }
    ],
    "x_advisoryEoL": false,
    "x_affectedList": [
        "PAN-OS 10.2.2-h1",
        "PAN-OS 10.2.2",
        "PAN-OS 10.2.1",
        "PAN-OS 10.2.0",
        "PAN-OS 10.2",
        "PAN-OS 10.1.6-h5",
        "PAN-OS 10.1.6-h4",
        "PAN-OS 10.1.6-h3",
        "PAN-OS 10.1.6-h2",
        "PAN-OS 10.1.6-h1",
        "PAN-OS 10.1.6",
        "PAN-OS 10.1.5-h2",
        "PAN-OS 10.1.5-h1",
        "PAN-OS 10.1.5",
        "PAN-OS 10.1.4-h4",
        "PAN-OS 10.1.4-h3",
        "PAN-OS 10.1.4-h2",
        "PAN-OS 10.1.4-h1",
        "PAN-OS 10.1.4",
        "PAN-OS 10.1.3",
        "PAN-OS 10.1.2",
        "PAN-OS 10.1.1",
        "PAN-OS 10.1.0",
        "PAN-OS 10.1",
        "PAN-OS 10.0.11",
        "PAN-OS 10.0.10",
        "PAN-OS 10.0.9",
        "PAN-OS 10.0.8-h8",
        "PAN-OS 10.0.8-h7",
        "PAN-OS 10.0.8-h6",
        "PAN-OS 10.0.8-h5",
        "PAN-OS 10.0.8-h4",
        "PAN-OS 10.0.8-h3",
        "PAN-OS 10.0.8-h2",
        "PAN-OS 10.0.8-h1",
        "PAN-OS 10.0.8",
        "PAN-OS 10.0.7",
        "PAN-OS 10.0.6",
        "PAN-OS 10.0.5",
        "PAN-OS 10.0.4",
        "PAN-OS 10.0.3",
        "PAN-OS 10.0.2",
        "PAN-OS 10.0.1",
        "PAN-OS 10.0.0",
        "PAN-OS 10.0",
        "PAN-OS 9.1.14-h3",
        "PAN-OS 9.1.14-h2",
        "PAN-OS 9.1.14-h1",
        "PAN-OS 9.1.14",
        "PAN-OS 9.1.13-h3",
        "PAN-OS 9.1.13-h2",
        "PAN-OS 9.1.13-h1",
        "PAN-OS 9.1.13",
        "PAN-OS 9.1.12-h3",
        "PAN-OS 9.1.12-h2",
        "PAN-OS 9.1.12-h1",
        "PAN-OS 9.1.12",
        "PAN-OS 9.1.11-h3",
        "PAN-OS 9.1.11-h2",
        "PAN-OS 9.1.11-h1",
        "PAN-OS 9.1.11",
        "PAN-OS 9.1.10",
        "PAN-OS 9.1.9",
        "PAN-OS 9.1.8",
        "PAN-OS 9.1.7",
        "PAN-OS 9.1.6",
        "PAN-OS 9.1.5",
        "PAN-OS 9.1.4",
        "PAN-OS 9.1.3-h1",
        "PAN-OS 9.1.3",
        "PAN-OS 9.1.2-h1",
        "PAN-OS 9.1.2",
        "PAN-OS 9.1.1",
        "PAN-OS 9.1.0-h3",
        "PAN-OS 9.1.0-h2",
        "PAN-OS 9.1.0-h1",
        "PAN-OS 9.1.0",
        "PAN-OS 9.1",
        "PAN-OS 9.0.16-h2",
        "PAN-OS 9.0.16-h1",
        "PAN-OS 9.0.16",
        "PAN-OS 9.0.15",
        "PAN-OS 9.0.14-h4",
        "PAN-OS 9.0.14-h3",
        "PAN-OS 9.0.14-h2",
        "PAN-OS 9.0.14-h1",
        "PAN-OS 9.0.14",
        "PAN-OS 9.0.13",
        "PAN-OS 9.0.12",
        "PAN-OS 9.0.11",
        "PAN-OS 9.0.10",
        "PAN-OS 9.0.9-h1",
        "PAN-OS 9.0.9",
        "PAN-OS 9.0.8",
        "PAN-OS 9.0.7",
        "PAN-OS 9.0.6",
        "PAN-OS 9.0.5",
        "PAN-OS 9.0.4",
        "PAN-OS 9.0.3-h3",
        "PAN-OS 9.0.3-h2",
        "PAN-OS 9.0.3-h1",
        "PAN-OS 9.0.3",
        "PAN-OS 9.0.2-h4",
        "PAN-OS 9.0.2-h3",
        "PAN-OS 9.0.2-h2",
        "PAN-OS 9.0.2-h1",
        "PAN-OS 9.0.2",
        "PAN-OS 9.0.1",
        "PAN-OS 9.0.0",
        "PAN-OS 9.0",
        "PAN-OS 8.1.23",
        "PAN-OS 8.1.22",
        "PAN-OS 8.1.21-h1",
        "PAN-OS 8.1.21",
        "PAN-OS 8.1.20-h1",
        "PAN-OS 8.1.20",
        "PAN-OS 8.1.19",
        "PAN-OS 8.1.18",
        "PAN-OS 8.1.17",
        "PAN-OS 8.1.16",
        "PAN-OS 8.1.15-h3",
        "PAN-OS 8.1.15-h2",
        "PAN-OS 8.1.15-h1",
        "PAN-OS 8.1.15",
        "PAN-OS 8.1.14-h2",
        "PAN-OS 8.1.14-h1",
        "PAN-OS 8.1.14",
        "PAN-OS 8.1.13",
        "PAN-OS 8.1.12",
        "PAN-OS 8.1.11",
        "PAN-OS 8.1.10",
        "PAN-OS 8.1.9-h4",
        "PAN-OS 8.1.9-h3",
        "PAN-OS 8.1.9-h2",
        "PAN-OS 8.1.9-h1",
        "PAN-OS 8.1.9",
        "PAN-OS 8.1.8-h5",
        "PAN-OS 8.1.8-h4",
        "PAN-OS 8.1.8-h3",
        "PAN-OS 8.1.8-h2",
        "PAN-OS 8.1.8-h1",
        "PAN-OS 8.1.8",
        "PAN-OS 8.1.7",
        "PAN-OS 8.1.6-h2",
        "PAN-OS 8.1.6-h1",
        "PAN-OS 8.1.6",
        "PAN-OS 8.1.5",
        "PAN-OS 8.1.4",
        "PAN-OS 8.1.3",
        "PAN-OS 8.1.2",
        "PAN-OS 8.1.1",
        "PAN-OS 8.1.0",
        "PAN-OS 8.1"
    ]
}