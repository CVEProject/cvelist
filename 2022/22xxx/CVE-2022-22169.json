{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2022-01-12T17:00:00.000Z",
        "ID": "CVE-2022-22169",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS and Junos OS Evolved: OSPFv3 session might go into INIT state upon receipt of multiple crafted packets from a trusted neighbor device."
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "!",
                                            "version_name": "12.3",
                                            "version_value": "Any"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "15.1",
                                            "version_value": "15.1R7-S11"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S6"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S9, 18.4R3-S10"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R2-S3, 19.1R3-S7"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S7, 19.2R3-S4"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S7, 19.3R3-S4"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R3-S6"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R3-S1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3-S3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R3-S1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R2-S2, 20.4R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "21.1",
                                            "version_value": "21.1R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "21.2",
                                            "version_value": "21.2R1-S1, 21.2R2"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS Evolved",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_value": "21.2R2-EVO"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "The following minimal configuration is required: \n\nYou must activate both OSPF and OSPF3 on one or more of the same interfaces concurrently on a device with an established peer with both OSPF and OSPF3 also activated, and sessions established.  \n\nAn example of minimal details are: \n  [protocols ospf]\n  [protocols ospf3]"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Improper Initialization vulnerability in the routing protocol daemon (rpd) of Juniper Networks Junos OS and Junos OS Evolved allows an attacker who sends specific packets in certain orders and at specific timings to force OSPFv3 to unexpectedly enter graceful-restart (GR helper mode) even though there is not any Grace-LSA received in OSPFv3 causing a Denial of Service (DoS). Unexpectedly entering GR helper mode might cause the OSPFv3 neighbor adjacency formed on this interface to be stuck in the \"INIT\" state which can be observed by issuing the following command: user@device> show ospf3 neighbor ID Interface State xx.xx.xx.xx ae100.0 Init <<<<<<<<<< An indicator of compromise can be seen in log files when traceoptions for OSPFv3 are enabled before the issue occurs. These logfile messages are as follows: OSPF restart signaling: Received hello with LR bit set from nbr ip=xx::xx id=xx.xx.xx.xx. Set oob-resync capabilty 1. OSPF Restart Signaling: Start helper mode for nbr ip xx::xx id xx.xx.xx.xx OSPF restart signaling: abort helper mode for nbr ip=xx::xx id=xx.xx.xx.xx OSPF neighbor xx::xx (realm ipv6-unicast <interface.unit> area xx.xx.xx.xx) state changed from Full to Init due to 1WayRcvd (event reason: neighbor is in one-way mode) (nbr helped: 0) This issue affects: Juniper Networks Junos OS. 15.1 versions prior to 15.1R7-S11; 18.3 versions prior to 18.3R3-S6; 18.4 versions prior to 18.4R2-S9, 18.4R3-S10; 19.1 versions prior to 19.1R2-S3, 19.1R3-S7; 19.2 versions prior to 19.2R1-S7, 19.2R3-S4; 19.3 versions prior to 19.3R2-S7, 19.3R3-S4; 19.4 versions prior to 19.4R3-S6; 20.1 versions prior to 20.1R3-S1; 20.2 versions prior to 20.2R3-S3; 20.3 versions prior to 20.3R3-S1; 20.4 versions prior to 20.4R2-S2, 20.4R3; 21.1 versions prior to 21.1R3; 21.2 versions prior to 21.2R1-S1, 21.2R2. This issue does not affect any version of Juniper Networks Junos OS 12.3. This issue affects Juniper Networks Junos OS Evolved all versions prior to 21.2R2-EVO."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-665 Improper Initialization"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11276",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11276"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue:\nJunos OS: 15.1R7-S11, 18.3R3-S6, 18.4R2-S9, 18.4R3-S10, 19.1R2-S3, 19.1R3-S7, 19.2R1-S7, 19.2R3-S4, 19.3R2-S7, 19.3R3-S4, 19.4R3-S6, 20.1R3-S1, 20.2R3-S3, 20.3R3-S1, 20.4R2-S2, 20.4R3, 21.1R3, 21.2R1-S1, 21.2R2, 21.3R1, and all subsequent releases.\n\nJunos OS Evolved: 21.2R2-EVO, 21.3R1-EVO, and all subsequent releases."
        }
    ],
    "source": {
        "advisory": "JSA11276",
        "defect": [
            "1599491"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "To work around this issue, disable the OSPF GR helper mode for OSPFv3:\n\n  [protocols ospf3 graceful-restart helper-disable]\n\nThere are no other workarounds for this issue."
        }
    ]
}