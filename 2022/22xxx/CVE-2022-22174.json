{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2022-01-12T17:00:00.000Z",
        "ID": "CVE-2022-22174",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: QFX5000 Series, EX4600: Device may run out of memory, causing traffic loss, upon receipt of specific IPv6 packets"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S6"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S9, 18.4R3-S9"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R2-S3, 19.1R3-S7"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S8, 19.2R3-S3"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S7, 19.3R3-S4"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R2-S5, 19.4R3-S6"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R3-S1"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3-S2"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R3-S1"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R3"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "21.1",
                                            "version_value": "21.1R2-S1, 21.1R3"
                                        },
                                        {
                                            "platform": "QFX5000 Series, EX4600",
                                            "version_affected": "<",
                                            "version_name": "21.2",
                                            "version_value": "21.2R1-S1, 21.2R2"
                                        },
                                        {
                                            "version_affected": "!<",
                                            "version_value": "17.4R3"
                                        },
                                        {
                                            "version_affected": "!<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S6"
                                        },
                                        {
                                            "version_affected": "!<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R3"
                                        },
                                        {
                                            "version_affected": "!<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3"
                                        },
                                        {
                                            "version_affected": "!<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2"
                                        },
                                        {
                                            "version_affected": "!<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A vulnerability in the processing of inbound IPv6 packets in Juniper Networks Junos OS on QFX5000 Series and EX4600 switches may cause the memory to not be freed, leading to a packet DMA memory leak, and eventual Denial of Service (DoS) condition. Once the condition occurs, further packet processing will be impacted, creating a sustained Denial of Service (DoS) condition. The following error logs may be observed using the \"show heap\" command and the device may eventually run out of memory if such packets are received continuously. Jan 12 12:00:00 device-name fpc0 (buf alloc) failed allocating packet buffer Jan 12 12:00:01 device-name fpc0 (buf alloc) failed allocating packet buffer user@device-name> request pfe execute target fpc0 timeout 30 command \"show heap\" ID Base Total(b) Free(b) Used(b) % Name -- ---------- ----------- ----------- ----------- --- ----------- 0 246fc1a8 536870488 353653752 183216736 34 Kernel 1 91800000 16777216 12069680 4707536 28 DMA 2 92800000 75497472 69997640 5499832 7 PKT DMA DESC 3 106fc000 335544320 221425960 114118360 34 Bcm_sdk 4 97000000 176160768 200 176160568 99 Packet DMA <<<<<<<<<<<<<< 5 903fffe0 20971504 20971504 0 0 Blob This issue affects Juniper Networks Junos OS on QFX5000 Series, EX4600: 18.3R3 versions prior to 18.3R3-S6; 18.4 versions prior to 18.4R2-S9, 18.4R3-S9; 19.1 versions prior to 19.1R2-S3, 19.1R3-S7; 19.2 versions prior to 19.2R1-S8, 19.2R3-S3; 19.3 versions prior to 19.3R2-S7, 19.3R3-S4; 19.4 versions prior to 19.4R2-S5, 19.4R3-S6; 20.1 versions prior to 20.1R3-S1; 20.2 versions prior to 20.2R3-S2; 20.3 versions prior to 20.3R3-S1; 20.4 versions prior to 20.4R3; 21.1 versions prior to 21.1R2-S1, 21.1R3; 21.2 versions prior to 21.2R1-S1, 21.2R2. This issue does not affect Juniper Networks Junos OS: Any versions prior to 17.4R3; 18.1 versions prior to 18.1R3-S6; 18.2 versions prior to 18.2R3; 18.3 versions prior to 18.3R3; 18.4 versions prior to 18.4R2; 19.1 versions prior to 19.1R2."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-755 Improper Handling of Exceptional Conditions"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-401 Improper Release of Memory Before Removing Last Reference"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11280",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11280"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: Junos OS 18.3R3-S6, 18.4R2-S9, 18.4R3-S9, 19.1R2-S3, 19.1R3-S7, 19.2R1-S8, 19.2R3-S3, 19.3R2-S7, 19.3R3-S4, 19.4R2-S5, 19.4R3-S6, 20.1R3-S1, 20.2R3-S2, 20.3R3-S1, 20.4R3, 21.1R2-S1, 21.1R3, 21.2R1-S1, 21.2R2, 21.3R1, 21.4R1, and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA11280",
        "defect": [
            "1603531"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There are no viable workarounds for this issue."
        }
    ]
}