{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2022-07-13T16:00:00.000Z",
        "ID": "CVE-2022-22202",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: PTX Series: FPCs may restart unexpectedly upon receipt of specific MPLS packets with certain multi-unit interface configurations"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_value": "19.1R3-S9"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R3-S6"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R3-S6"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R3-S8"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R3-S4"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3-S5"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R3-S4"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R3-S4"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "21.1",
                                            "version_value": "21.1R3-S2"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "21.2",
                                            "version_value": "21.2R3-S1"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "21.3",
                                            "version_value": "21.3R3"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "21.4",
                                            "version_value": "21.4R2"
                                        },
                                        {
                                            "platform": "PTX Series",
                                            "version_affected": "<",
                                            "version_name": "22.1",
                                            "version_value": "22.1R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "The FPC crash only occurs if specific MPLS packets are received on an interface with multiple units configured and at least one unit has 'family mpls' not configured. Also, the first unit with family mpls configured is not the lowest numerical unit on that interface.\n\nA sample vulnerable configuration utilizing multiple units on an interface with MPLS enabled is shown below:\n\n  set interfaces et-0/0/37:2 vlan-tagging\n  set interfaces et-0/0/37:2 unit 0 vlan-id 0  <<< 'family mpls' not configured\n  set interfaces et-0/0/37:2 unit 5 vlan-id 3000\n  set interfaces et-0/0/37:2 unit 5 family inet6 address fe80::ce1/64\n  set interfaces et-0/0/37:2 unit 7 vlan-id 3032\n  set interfaces et-0/0/37:2 unit 7 family inet address 169.254.101.23/31\n  set interfaces et-0/0/37:2 unit 7 family inet6\n  set interfaces et-0/0/37:2 unit 7 family mpls  <<< 'family' mpls configured, but not the lowest unit number\n  set interfaces et-0/0/37:2 unit 10 vlan-id 10\n  set interfaces et-0/0/37:2 unit 10 family inet address 192.168.10.1/24\n  set interfaces et-0/0/37:2 unit 10 family iso\n  set interfaces et-0/0/37:2 unit 10 family mpls\n..."
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Improper Handling of Exceptional Conditions vulnerability on specific PTX Series devices, including the PTX1000, PTX3000 (NextGen), PTX5000, PTX10002-60C, PTX10008, and PTX10016 Series, in Juniper Networks Junos OS allows an unauthenticated MPLS-based attacker to cause a Denial of Service (DoS) by triggering the dcpfe process to crash and FPC to restart.  On affected PTX Series devices, processing specific MPLS packets received on an interface with multiple units configured may cause FPC to restart unexpectedly.  Continued receipt and processing of this packet will create a sustained Denial of Service (DoS) condition.\n\nThis issue only affects PTX Series devices utilizing specific FPCs found on PTX1000, PTX3000 (NextGen), PTX5000, PTX10002-60C, PTX10008, and PTX10016 Series devices, only if multiple units are configured on the ingress interface, and at least one unit has 'family mpls' *not* configured.  See the configuration sample below for more information.\n\nNo other platforms are affected by this vulnerability.\nThis issue affects:\nJuniper Networks Junos OS on PTX Series:\nAll versions prior to 19.1R3-S9;\n19.2 versions prior to 19.2R3-S6;\n19.3 versions prior to 19.3R3-S6;\n19.4 versions prior to 19.4R3-S8;\n20.1 versions prior to 20.1R3-S4;\n20.2 versions prior to 20.2R3-S5;\n20.3 versions prior to 20.3R3-S4;\n20.4 versions prior to 20.4R3-S4;\n21.1 versions prior to 21.1R3-S2;\n21.2 versions prior to 21.2R3-S1;\n21.3 versions prior to 21.3R3;\n21.4 versions prior to 21.4R2;\n22.1 versions prior to 22.1R2.\n"
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-755 Improper Handling of Exceptional Conditions"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA69706",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA69706"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: Junos OS 19.1R3-S9, 19.2R3-S6, 19.3R3-S6, 19.4R3-S8, 20.1R3-S4, 20.2R3-S5, 20.3R3-S4, 20.4R3-S4, 21.1R3-S2, 21.2R3-S1, 21.3R3, 21.4R2, 22.1R2, 22.2R1, and all subsequent releases."
        }
    ],
    "source": {
        "advisory": "JSA69706",
        "defect": [
            "1649586"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "The FPC crash only occurs if specific MPLS packets are received on an interface with multiple units configured and at least one unit has family mpls not configured. Also, the first unit with family mpls configured is not the lowest numerical unit on that interface.\n\nA viable config-based workaround would be to reorder the unit numbers on core-facing interfaces to ensure the numerically lowest unit has 'family mpls' configured.\n"
        }
    ]
}