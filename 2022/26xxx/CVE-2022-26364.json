{
   "CVE_data_meta" : {
      "ASSIGNER" : "security@xenproject.org",
      "ID" : "CVE-2022-26364"
   },
   "affects" : {
      "vendor" : {
         "vendor_data" : [
            {
               "product" : {
                  "product_data" : [
                     {
                        "product_name" : "xen",
                        "version" : {
                           "version_data" : [
                              {
                                 "version_affected" : "?",
                                 "version_value" : "consult Xen advisory XSA-402"
                              }
                           ]
                        }
                     }
                  ]
               },
               "vendor_name" : "Xen"
            }
         ]
      }
   },
   "configuration" : {
      "configuration_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "All versions of Xen are vulnerable.\n\nOnly x86 PV guests can trigger this vulnerability.\n\nOnly x86 PV guests configured with access to devices (e.g. PCI\nPassthrough) can trigger the vulnerability.\n\nOnly CPUs which can issue non-coherent memory accesses are impacted.\nCPUs which enumerate the SelfSnoop feature are not impacted, except as\nnoted in errata.  Therefore, we believe that Xen running on Intel\nIvyBridge or later CPUs is not impacted by the vulnerability."
               }
            ]
         }
      }
   },
   "credit" : {
      "credit_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "This issue was discovered by Jann Horn of Google Project Zero."
               }
            ]
         }
      }
   },
   "data_format" : "MITRE",
   "data_type" : "CVE",
   "data_version" : "4.0",
   "description" : {
      "description_data" : [
         {
            "lang" : "eng",
            "value" : "x86 pv: Insufficient care with non-coherent mappings\n\nT[his CNA information record relates to multiple CVEs; the\ntext explains which aspects/vulnerabilities correspond to which CVE.]\n\nXen maintains a type reference count for pages, in addition to a regular\nreference count.  This scheme is used to maintain invariants required\nfor Xen's safety, e.g. PV guests may not have direct writeable access to\npagetables; updates need auditing by Xen.\n\nUnfortunately, Xen's safety logic doesn't account for CPU-induced cache\nnon-coherency; cases where the CPU can cause the content of the cache to\nbe different to the content in main memory.  In such cases, Xen's safety\nlogic can incorrectly conclude that the contents of a page is safe."
         }
      ]
   },
   "impact" : {
      "impact_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Malicious x86 PV guest administrators can escalate privilege so as to\ncontrol the whole system."
               }
            ]
         }
      }
   },
   "problemtype" : {
      "problemtype_data" : [
         {
            "description" : [
               {
                  "lang" : "eng",
                  "value" : "unknown"
               }
            ]
         }
      ]
   },
   "references" : {
      "reference_data" : [
         {
            "url" : "https://xenbits.xenproject.org/xsa/advisory-402.txt"
         }
      ]
   },
   "workaround" : {
      "workaround_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Not passing devices through to untrusted x86 PV guests will avoid the\nvulnerability."
               }
            ]
         }
      }
   }
}
