{
    "CVE_data_meta": {
        "ASSIGNER": "security-advisories@github.com",
        "ID": "CVE-2022-29165",
        "STATE": "PUBLIC",
        "TITLE": "Argo CD will blindly trust JWT claims if anonymous access is enabled"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "argo-cd",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": ">= 1.4.0, < 2.1.15"
                                        },
                                        {
                                            "version_value": ">= 2.2.0, < 2.2.9"
                                        },
                                        {
                                            "version_value": ">= 2.3.0, < 2.3.4"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "argoproj"
                }
            ]
        }
    },
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. A critical vulnerability has been discovered in Argo CD starting with version 1.4.0 and prior to versions 2.1.15, 2.2.9, and 2.3.4 which would allow unauthenticated users to impersonate as any Argo CD user or role, including the `admin` user, by sending a specifically crafted JSON Web Token (JWT) along with the request. In order for this vulnerability to be exploited, anonymous access to the Argo CD instance must have been enabled. In a default Argo CD installation, anonymous access is disabled. The vulnerability can be exploited to impersonate as any user or role, including the built-in `admin` account regardless of whether it is enabled or disabled. Also, the attacker does not need an account on the Argo CD instance in order to exploit this. If anonymous access to the instance is enabled, an attacker can escalate their privileges, effectively allowing them to gain the same privileges on the cluster as the Argo CD instance, which is cluster admin in a default installation. This will allow the attacker to create, manipulate and delete any resource on the cluster. They may also exfiltrate data by deploying malicious workloads with elevated privileges, thus bypassing any redaction of sensitive data otherwise enforced by the Argo CD API. A patch for this vulnerability has been released in Argo CD versions 2.3.4, 2.2.9, and 2.1.15. As a workaround, one may disable anonymous access, but upgrading to a patched version is preferable."
            }
        ]
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 10.0,
            "baseSeverity": "CRITICAL",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "CHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-287: Improper Authentication"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-290: Authentication Bypass by Spoofing"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://github.com/argoproj/argo-cd/releases/tag/v2.1.15",
                "refsource": "MISC",
                "url": "https://github.com/argoproj/argo-cd/releases/tag/v2.1.15"
            },
            {
                "name": "https://github.com/argoproj/argo-cd/releases/tag/v2.2.9",
                "refsource": "MISC",
                "url": "https://github.com/argoproj/argo-cd/releases/tag/v2.2.9"
            },
            {
                "name": "https://github.com/argoproj/argo-cd/releases/tag/v2.3.4",
                "refsource": "MISC",
                "url": "https://github.com/argoproj/argo-cd/releases/tag/v2.3.4"
            },
            {
                "name": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-r642-gv9p-2wjj",
                "refsource": "CONFIRM",
                "url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-r642-gv9p-2wjj"
            }
        ]
    },
    "source": {
        "advisory": "GHSA-r642-gv9p-2wjj",
        "discovery": "UNKNOWN"
    }
}