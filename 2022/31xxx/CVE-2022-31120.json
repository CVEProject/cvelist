{
    "CVE_data_meta": {
        "ASSIGNER": "security-advisories@github.com",
        "ID": "CVE-2022-31120",
        "STATE": "PUBLIC",
        "TITLE": "Federated share accepting/declining is not logged in audit log in Nextcloud Server"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "security-advisories",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": ">= 23.0.0, < 23.0.4"
                                        },
                                        {
                                            "version_value": "< 22.2.7"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "nextcloud"
                }
            ]
        }
    },
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "Nextcloud server is an open source personal cloud solution. The audit log is used to get a full trail of the actions which has been incompletely populated. In affected versions federated share events were not properly logged which would allow brute force attacks to go unnoticed. This behavior exacerbates the impact of CVE-2022-31118. It is recommended that the Nextcloud Server is upgraded to 22.2.7, 23.0.4 or 24.0.0. There are no workarounds available."
            }
        ]
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT",
            "availabilityImpact": "NONE",
            "baseScore": 2.1,
            "baseSeverity": "LOW",
            "confidentialityImpact": "NONE",
            "integrityImpact": "LOW",
            "privilegesRequired": "HIGH",
            "scope": "UNCHANGED",
            "userInteraction": "REQUIRED",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-778: Insufficient Logging"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-9qvg-7fwg-722x",
                "refsource": "CONFIRM",
                "url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-9qvg-7fwg-722x"
            },
            {
                "name": "https://github.com/nextcloud/server/pull/31594/commits/1d8bf9a89c6856218802a1d365000a5831be8655",
                "refsource": "MISC",
                "url": "https://github.com/nextcloud/server/pull/31594/commits/1d8bf9a89c6856218802a1d365000a5831be8655"
            },
            {
                "name": "https://portal.nextcloud.com/article/using-the-audit-log-44.html",
                "refsource": "MISC",
                "url": "https://portal.nextcloud.com/article/using-the-audit-log-44.html"
            }
        ]
    },
    "source": {
        "advisory": "GHSA-9qvg-7fwg-722x",
        "discovery": "UNKNOWN"
    }
}