{
    "CVE_data_meta": {
        "ASSIGNER": "productsecurity@carrier.com",
        "DATE_PUBLIC": "2022-06-02T22:00:00.000Z",
        "ID": "CVE-2022-31479",
        "STATE": "PUBLIC",
        "TITLE": "Remote Code Execution via command injection of the hostname"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "LNL-X2210",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "LNL-X2220",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "LNL-X3300",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "LNL-X4420",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "LNL-4420",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.296"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "S2-LP-1501",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "S2-LP-1502",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "S2-LP-2500",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "S2-LP-4502",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "LenelS2"
                },
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "LP1501",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "LP1502",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "LP2500",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "LP4502",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.302"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "EP4502",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "ALL",
                                            "version_value": "1.296"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "HID Mercury"
                }
            ]
        }
    },
    "credit": [
        {
            "lang": "eng",
            "value": "Sam Quinn @eAyeP and Steve Povolny @spovolny from Trellix Threat Labs"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An unauthenticated attacker can update the hostname with a specially crafted name that will allow for shell commands to be executed during the core collection process. This vulnerability impacts products based on HID Mercury Intelligent Controllers LP1501, LP1502, LP2500, LP4502, and EP4502 which contain firmware versions prior to 1.302 for the LP series and 1.296 for the EP series. An attacker with this level of access on the device can monitor all communications sent to and from this device, modify onboard relays, change configuration files, or cause the device to become unstable. The injected commands only get executed during start up or when unsafe calls regarding the hostname are used. This allows the attacker to gain remote access to the device and can make their persistence permanent by modifying the filesystem."
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 9.6,
            "baseSeverity": "CRITICAL",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "CHANGED",
            "userInteraction": "REQUIRED",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-693 Protection Mechanism Failure"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "MISC",
                "url": "https://www.corporate.carrier.com/product-security/advisories-resources/",
                "name": "https://www.corporate.carrier.com/product-security/advisories-resources/"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "Update to the latest version of firmware"
        }
    ],
    "source": {
        "advisory": "CARR-PSA-006-0522",
        "discovery": "EXTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "Disable the controller's Web Server.  \nWhen the controller is configured to disable web access, you cannot remotely login into the controller\u2019s web page.\n1. Login to controller web pages\n2. Go to \u201cUsers\u201d Tab\n3. Near bottom of the Users page, check option to \u201cDisable Web Server\u201d\n4. Then select \u201cSubmit\u201d at the bottom of the page\n5. Then select \u201cApply Settings\u201d tab\n6. And on that page, select button \u201cApply Settings, Reboot\u201d\nThe Controller will apply the new setting and reboot. Web login will be disabled until switch 1 is physically turned ON, on the controller."
        }
    ]
}