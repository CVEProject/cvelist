{
    "CVE_data_meta": {
        "ASSIGNER": "security@xen.org",
        "ID": "CVE-2022-42331",
        "STATE": "PUBLIC"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "xen",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "?",
                                            "version_value": "consult Xen advisory XSA-429"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Xen"
                }
            ]
        }
    },
    "configuration": {
        "configuration_data": {
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "Xen versions 4.5 through 4.17 are vulnerable.  Older versions are not\nvulnerable.\n\nOnly x86 CPUs are potentially vulnerable.  CPUs of other architectures\nare not vulnerable.\n\nThe problematic codepath is only reachable on x86 CPUs which follow\nAMD's behaviour with respect to SYSCALL instructions from compatibility\nmode segments.  This means that AMD and Hygon CPUs are potentially\nvulnerable, whereas Intel CPUs are not.  Other vendors have not been\nchecked.\n\nOnly PV guests can leverage the vulnerability.\n\nOn Xen 4.16 and later, the vulnerability is only present if 32bit PV\nguest support is compiled in - i.e. CONFIG_PV32=y.  On Xen 4.15 and\nolder, all supported build configurations are vulnerable.\n\nThe vulnerability is only present when booting on hardware that supports\nSMEP or SMAP (Supervisor Mode Execution/Access Prevention).  This is\nbelieved to be some Family 0x16 models, and all later CPUs."
                    }
                ]
            }
        }
    },
    "credit": {
        "credit_data": {
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "This issue was discovered by Andrew Cooper of XenServer."
                    }
                ]
            }
        }
    },
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "x86: speculative vulnerability in 32bit SYSCALL path Due to an oversight in the very original Spectre/Meltdown security work (XSA-254), one entrypath performs its speculation-safety actions too late. In some configurations, there is an unprotected RET instruction which can be attacked with a variety of speculative attacks."
            }
        ]
    },
    "impact": {
        "impact_data": {
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "An attacker might be able to infer the contents of arbitrary host\nmemory, including memory assigned to other guests."
                    }
                ]
            }
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "unknown"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "url": "https://xenbits.xenproject.org/xsa/advisory-429.txt",
                "refsource": "MISC",
                "name": "https://xenbits.xenproject.org/xsa/advisory-429.txt"
            },
            {
                "refsource": "MLIST",
                "name": "[oss-security] 20230321 Xen Security Advisory 429 v3 (CVE-2022-42331) - x86: speculative vulnerability in 32bit SYSCALL path",
                "url": "http://www.openwall.com/lists/oss-security/2023/03/21/3"
            },
            {
                "refsource": "CONFIRM",
                "name": "http://xenbits.xen.org/xsa/advisory-429.html",
                "url": "http://xenbits.xen.org/xsa/advisory-429.html"
            }
        ]
    },
    "workaround": {
        "workaround_data": {
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "Not running untrusted PV guests will avoid the issue."
                    }
                ]
            }
        }
    }
}