{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2023-01-11T17:00:00.000Z",
        "ID": "CVE-2023-22405",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: QFX5k Series, EX46xx Series: MAC limiting feature stops working after PFE restart or device reboot"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "QFX5k Series, EX46xx Series",
                                            "version_affected": "<",
                                            "version_value": "20.2R3-S5"
                                        },
                                        {
                                            "platform": "QFX5k Series, EX46xx Series",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R3-S5"
                                        },
                                        {
                                            "platform": "QFX5k Series, EX46xx Series",
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R3-S4"
                                        },
                                        {
                                            "platform": "QFX5k Series, EX46xx Series",
                                            "version_affected": "<",
                                            "version_name": "21.1",
                                            "version_value": "21.1R3-S3"
                                        },
                                        {
                                            "platform": "QFX5k Series, EX46xx Series",
                                            "version_affected": "<",
                                            "version_name": "21.2",
                                            "version_value": "21.2R3-S1"
                                        },
                                        {
                                            "platform": "QFX5k Series, EX46xx Series",
                                            "version_affected": "<",
                                            "version_name": "21.3",
                                            "version_value": "21.3R3"
                                        },
                                        {
                                            "platform": "QFX5k Series, EX46xx Series",
                                            "version_affected": "<",
                                            "version_name": "21.4",
                                            "version_value": "21.4R3"
                                        },
                                        {
                                            "platform": "QFX5k Series, EX46xx Series",
                                            "version_affected": "<",
                                            "version_name": "22.1",
                                            "version_value": "22.1R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "To be vulnerable to this issue a \"service provider/SP\"-style configuration like the following needs to be present:\n\n  [interfaces <interface> ether-options 802.3ad ae<#>]\n  [interfaces ae<#> unit <unit> vlan-id <id>]\n  [switch-options interface ae<#>.<id> interface-mac-limit <limit>]\n  [switch-options interface ae<#>.<id> interface-mac-limit packet-action <action>]"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Improper Preservation of Consistency Between Independent Representations of Shared State vulnerability in the Packet Forwarding Engine (PFE) of Juniper Networks Junos OS allows an adjacent, unauthenticated attacker to cause a Denial of Service (DoS) to device due to out of resources. When a device is configured with \"service-provider/SP style\" switching, and mac-limiting is configured on an Aggregated Ethernet (ae) interface, and then a PFE is restarted or the device is rebooted, mac-limiting doesn't work anymore. Please note that the issue might not be apparent as traffic will continue to flow through the device although the mac table and respective logs will indicate that mac limit is reached. Functionality can be restored by removing and re-adding the MAC limit configuration. This issue affects Juniper Networks Junos OS on QFX5k Series, EX46xx Series: All versions prior to 20.2R3-S5; 20.3 versions prior to 20.3R3-S5; 20.4 versions prior to 20.4R3-S4; 21.1 versions prior to 21.1R3-S3; 21.2 versions prior to 21.2R3-S1; 21.3 versions prior to 21.3R3 on; 21.4 versions prior to 21.4R3 on; 22.1 versions prior to 22.1R2 on."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-1250 Improper Preservation of Consistency Between Independent Representations of Shared State"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA70201",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA70201"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 20.2R3-S5, 20.3R3-S5, 20.4R3-S4, 21.1R3-S3, 21.2R3-S1, 21.3R3, 21.4R3, 22.1R2, 22.2R1, and all subsequent releases."
        }
    ],
    "source": {
        "advisory": "JSA70201",
        "defect": [
            "1659873"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There are no known workarounds for this issue."
        }
    ]
}