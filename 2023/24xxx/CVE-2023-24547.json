{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2023-24547",
        "ASSIGNER": "psirt@arista.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On affected platforms running Arista MOS, the configuration of a BGP password will cause the password to be logged in clear text that can be revealed in local logs or remote logging servers by authenticated users, as well as appear in clear text in the device\u2019s running config. \n"
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "cwe-212"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Arista Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "MOS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "0.13.0",
                                            "version_value": "0.39.4"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/18644-security-advisory-0090",
                "refsource": "MISC",
                "name": "https://www.arista.com/en/support/advisories-notices/security-advisory/18644-security-advisory-0090"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "advisory": "90",
        "defect": [
            "BUG868319",
            "BUG873034",
            "MOS-2222",
            "MOS-2255."
        ],
        "discovery": "INTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>In order to be vulnerable to CVE-2023-24547 the following condition must be met:</p><p>A BGP password must be configured and be in plain text. An example of this is shown below:</p><pre>switch&gt;show running-config bgp\nrouter bgp 65000\n&nbsp; &nbsp;neighbor 192.0.2.1 remote-as 66000\n&nbsp; &nbsp;<span style=\"background-color: rgb(255, 255, 0);\">neighbor 192.0.2.1 password pA$$w0rd</span>\n</pre><p>If a BGP password is not configured there is no exposure to this issue.</p><br>"
                }
            ],
            "value": "In order to be vulnerable to CVE-2023-24547 the following condition must be met:\n\nA BGP password must be configured and be in plain text. An example of this is shown below:\n\nswitch>show running-config bgp\nrouter bgp 65000\n\u00a0 \u00a0neighbor 192.0.2.1 remote-as 66000\n\u00a0 \u00a0neighbor 192.0.2.1 password pA$$w0rd\n\n\nIf a BGP password is not configured there is no exposure to this issue.\n\n\n"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<span style=\"background-color: rgb(255, 255, 255);\">No mitigation exists.</span><br>"
                }
            ],
            "value": "No mitigation exists.\n"
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see the <a target=\"_blank\" rel=\"nofollow\" href=\"https://mako.arista.com/dyn/softwareportal/artefact/3688/mos-0.39.1-userguide.pdf\">MOS User Guide: Updating</a></p><p>CVE-2023-24547 has been fixed in the following releases:</p><ul><li>MOS-0.36.10 and later releases in the MOS-0.36.x train</li><li>MOS-0.39.4 and later releases in the MOS-0.39.x train</li></ul><p>Because this issue would cause the password to be saved in logs and remote AAA servers it is recommended to also rotate the BGP password, if possible. Upon upgrading to a new release, the BGP password will be obfuscated with the type-7 algorithm as shown below:</p><pre>switch&gt;show running-config bgp\nrouter bgp 65000\n&nbsp; &nbsp;neighbor 192.0.2.1 remote-as 66000\n&nbsp; &nbsp;<span style=\"background-color: rgb(255, 255, 0);\">neighbor 192.0.2.1 password key 7 00143242404C5B140B</span>\n</pre><br><br>"
                }
            ],
            "value": "The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see the  MOS User Guide: Updating https://mako.arista.com/dyn/softwareportal/artefact/3688/mos-0.39.1-userguide.pdf \n\nCVE-2023-24547 has been fixed in the following releases:\n\n  *  MOS-0.36.10 and later releases in the MOS-0.36.x train\n  *  MOS-0.39.4 and later releases in the MOS-0.39.x train\n\n\nBecause this issue would cause the password to be saved in logs and remote AAA servers it is recommended to also rotate the BGP password, if possible. Upon upgrading to a new release, the BGP password will be obfuscated with the type-7 algorithm as shown below:\n\nswitch>show running-config bgp\nrouter bgp 65000\n\u00a0 \u00a0neighbor 192.0.2.1 remote-as 66000\n\u00a0 \u00a0neighbor 192.0.2.1 password key 7 00143242404C5B140B\n\n\n\n\n"
        },
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<h3>Hotfix</h3><p>The following hotfix can be applied to remediate CVE-2023-24547. The hotfix only applies to the releases listed below and no other releases. All other versions require upgrading to a release containing the fix (as listed above):</p><ul><li>MOS-0.39.3 and below releases in the MOS-0.39.x train</li><li>MOS-0.38.1 and below releases in the MOS-0.38.x train</li><li>MOS-0.37.1 and below releases in the MOS-0.37.x train</li><li>MOS-0.36.9 and below releases in the MOS-0.36.x train</li><li>MOS-0.35.3 and below releases in the MOS-0.35.x train</li><li>MOS-0.34.0 in the MOS-0.34.x train</li></ul><p>Please note that the only MOS release trains currently under maintenance support are MOS-0.39.x and MOS-0.36.x. The hotfix working for other releases should not be treated as evidence that these releases continue to be supported. For security it is important to ensure supported releases are used.</p><pre>Version: 1.0\nURL: <a target=\"_blank\" rel=\"nofollow\" href=\"https://artifacts.metamako.com/artifactory/releases/hotfix/4.0.0/hotfix-cve-2023-24547-4.0.0-1.14.core2_64.rpm\">hotfix-cve-2023-24547-4.0.0-1.14.core2_64.rpm</a>\nSWIX hash:(SHA512)\n168b2ee3deb8d4a3151b9c24936ff9d6523557b366ceffc98e57e8bf80638997\n</pre><div>&nbsp;</div><br>"
                }
            ],
            "value": "HotfixThe following hotfix can be applied to remediate CVE-2023-24547. The hotfix only applies to the releases listed below and no other releases. All other versions require upgrading to a release containing the fix (as listed above):\n\n  *  MOS-0.39.3 and below releases in the MOS-0.39.x train\n  *  MOS-0.38.1 and below releases in the MOS-0.38.x train\n  *  MOS-0.37.1 and below releases in the MOS-0.37.x train\n  *  MOS-0.36.9 and below releases in the MOS-0.36.x train\n  *  MOS-0.35.3 and below releases in the MOS-0.35.x train\n  *  MOS-0.34.0 in the MOS-0.34.x train\n\n\nPlease note that the only MOS release trains currently under maintenance support are MOS-0.39.x and MOS-0.36.x. The hotfix working for other releases should not be treated as evidence that these releases continue to be supported. For security it is important to ensure supported releases are used.\n\nVersion: 1.0\nURL:  hotfix-cve-2023-24547-4.0.0-1.14.core2_64.rpm https://artifacts.metamako.com/artifactory/releases/hotfix/4.0.0/hotfix-cve-2023-24547-4.0.0-1.14.core2_64.rpm \nSWIX hash:(SHA512)\n168b2ee3deb8d4a3151b9c24936ff9d6523557b366ceffc98e57e8bf80638997\n\n\n\u00a0\n\n\n"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "HIGH",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 5.9,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "NONE",
                "integrityImpact": "HIGH",
                "privilegesRequired": "HIGH",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:H",
                "version": "3.1"
            }
        ]
    }
}