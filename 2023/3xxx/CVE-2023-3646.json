{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2023-3646",
        "ASSIGNER": "psirt@arista.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On affected platforms running Arista EOS with mirroring to multiple destinations configured, an internal system error may trigger a kernel panic and cause system reload.\n"
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-125 Out-of-bounds Read",
                        "cweId": "CWE-125"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Arista Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "EOS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.28.2F",
                                            "version_value": "4.28.5.1M "
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.29.0",
                                            "version_value": "4.29.1F"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/18042-security-advisory-0088",
                "refsource": "MISC",
                "name": "https://www.arista.com/en/support/advisories-notices/security-advisory/18042-security-advisory-0088"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "advisory": "88",
        "defect": [
            "BUG829136",
            "BUG765111"
        ],
        "discovery": "INTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<b><p><span style=\"background-color: transparent;\">Mirroring to multiple destinations must be configured:</span></p><div><table><tbody><tr><td><p><span style=\"background-color: transparent;\">switch(config)#show monitor session</span></p><br><p><span style=\"background-color: transparent;\">Session s1</span></p><p><span style=\"background-color: transparent;\">------------------------</span></p><br><p><span style=\"background-color: transparent;\">Sources:</span></p><br><p><span style=\"background-color: transparent;\">Both Interfaces:  &nbsp; &nbsp; &nbsp; Et1/1</span></p><br><p><span style=\"background-color: transparent;\">Destination Ports:</span></p><br><p><span style=\"background-color: rgb(255, 255, 0);\">&nbsp; &nbsp; Et9/1 :  active</span></p><p><span style=\"background-color: rgb(255, 255, 0);\">&nbsp; &nbsp; Et10/1 :  active</span></p></td></tr></tbody></table></div><p><span style=\"background-color: transparent;\">In the above example two destinations, Et9/1 and Et10/1, are configured.</span></p><br><p><span style=\"background-color: transparent;\">Mirroring config must be added with mirror destination being ethernet port, example:</span></p><div><table><tbody><tr><td><p><span style=\"background-color: transparent;\">switch # show running-config | section monitor</span></p><p><span style=\"background-color: rgb(255, 255, 0);\">monitor session APCON destination Ethernet54/1</span></p></td></tr></tbody></table></div><p><span style=\"background-color: transparent;\">In the above example the argument after destination is an Ethernet port.</span></p></b><br><br>"
                }
            ],
            "value": "Mirroring to multiple destinations must be configured:\n\nswitch(config)#show monitor session\n\n\nSession s1\n\n------------------------\n\n\nSources:\n\n\nBoth Interfaces:  \u00a0 \u00a0 \u00a0 Et1/1\n\n\nDestination Ports:\n\n\n\u00a0 \u00a0 Et9/1 :  active\n\n\u00a0 \u00a0 Et10/1 :  active\n\n\n\nIn the above example two destinations, Et9/1 and Et10/1, are configured.\n\n\nMirroring config must be added with mirror destination being ethernet port, example:\n\nswitch # show running-config | section monitor\n\nmonitor session APCON destination Ethernet54/1\n\n\n\nIn the above example the argument after destination is an Ethernet port.\n\n\n\n"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<b><p><span style=\"background-color: transparent;\">The suggestion to prevent this issue is to remove any mirroring config</span></p><div><table><tbody><tr><td><p><span style=\"background-color: transparent;\">#show monitor session</span></p><p><span style=\"background-color: rgb(255, 255, 0);\">No sessions created</span></p></td></tr></tbody></table></div><p><span style=\"background-color: transparent;\">This example confirms that the system does not have any mirroring config present which will prevent this issue from occurring.</span></p></b><br><br>"
                }
            ],
            "value": "The suggestion to prevent this issue is to remove any mirroring config\n\n#show monitor session\n\nNo sessions created\n\n\n\nThis example confirms that the system does not have any mirroring config present which will prevent this issue from occurring.\n\n\n\n"
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below.<br>For more information about upgrading see <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades\">EOS User Manual: Upgrades and Downgrades</a></p><p>CVE-2023-3646 has been fixed in the following releases:</p><ul><li>4.28.6M and later releases in the 4.28.x train</li><li>4.29.2F and later releases in the 4.29.x train</li></ul>"
                }
            ],
            "value": "The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below.\nFor more information about upgrading see  EOS User Manual: Upgrades and Downgrades https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades \n\nCVE-2023-3646 has been fixed in the following releases:\n\n  *  4.28.6M and later releases in the 4.28.x train\n  *  4.29.2F and later releases in the 4.29.x train\n\n\n"
        },
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<h3>Hotfix</h3><p>The following hotfix can be applied to remediate CVE-2023-3646. The hotfix only applies to the releases listed below and no other releases. All other versions require upgrading to a release containing the fix (as listed above):</p><ul><li>4.28.2F through 4.28.5.1M releases in the 4.28.x train</li><li>4.29.1F and earlier releases in the 4.29.X train</li></ul><p>Note: Installing/uninstalling the Hotfix will result in a restart of the SandFapNi agent and an associated reprogramming of the switch chip. This process could result in outages from 5-20 minutes, depending on the number of active ports in the particular system.</p><p>To determine which hotfix to use, run \u201c<b>show version</b>\u201d from the CLI and refer to the \u201cArchitecture\u201d Field.</p><div>Version: 1.0<br>URL: <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.com/support/advisories-notices/sa-download/?sa=88-SecurityAdvisory88_CVE-2023-3646_Hotfix_i686.swix\">SecurityAdvisory88_CVE-2023-3646_Hotfix_i686.swix</a><pre>SWIX hash:(SHA-512)\n9c01d1bc1d657879e1a1b657a8c0dab090d589efc3f2c64e9cac1ae0356fce14496809893bffb0892b1505f8b4ee25cad0064bd7315ba6737dc5fdb200539f1a\n</pre></div><div>&nbsp;</div><div>URL: <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.com/support/advisories-notices/sa-download/?sa=88-SecurityAdvisory88_CVE-2023-3646_Hotfix_x86_64.swix\">SecurityAdvisory88_CVE-2023-3646_Hotfix_x86_64.swix</a><pre>SWIX hash:(SHA512)\n98e98c2c34f81df4da3e4068ac9a81191f4c6ef1acab884972d092c79a7495e00d9a25c8713620d3e25b4699f777810a627634eb8078dcbbb19317ed27a9b0d5 \n</pre></div><div>&nbsp;</div><p>For instructions on installation and verification of the hotfix patch, refer to the <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.com/en/um-eos/eos-managing-eos-extensions?searchword=eos%20section%206%206%20managing%20eos%20extensions\">\u201cmanaging eos extensions\u201d</a>&nbsp;section in the EOS User Manual. Ensure that the patch is made persistent across reboots by running the command \u2018copy installed-extensions boot-extensions\u2019.</p><br>"
                }
            ],
            "value": "HotfixThe following hotfix can be applied to remediate CVE-2023-3646. The hotfix only applies to the releases listed below and no other releases. All other versions require upgrading to a release containing the fix (as listed above):\n\n  *  4.28.2F through 4.28.5.1M releases in the 4.28.x train\n  *  4.29.1F and earlier releases in the 4.29.X train\n\n\nNote: Installing/uninstalling the Hotfix will result in a restart of the SandFapNi agent and an associated reprogramming of the switch chip. This process could result in outages from 5-20 minutes, depending on the number of active ports in the particular system.\n\nTo determine which hotfix to use, run \u201cshow version\u201d from the CLI and refer to the \u201cArchitecture\u201d Field.\n\nVersion: 1.0\nURL:  SecurityAdvisory88_CVE-2023-3646_Hotfix_i686.swix https://www.arista.com/support/advisories-notices/sa-download/ SWIX hash:(SHA-512)\n9c01d1bc1d657879e1a1b657a8c0dab090d589efc3f2c64e9cac1ae0356fce14496809893bffb0892b1505f8b4ee25cad0064bd7315ba6737dc5fdb200539f1a\n\n\n\n\n\u00a0\n\nURL:  SecurityAdvisory88_CVE-2023-3646_Hotfix_x86_64.swix https://www.arista.com/support/advisories-notices/sa-download/ SWIX hash:(SHA512)\n98e98c2c34f81df4da3e4068ac9a81191f4c6ef1acab884972d092c79a7495e00d9a25c8713620d3e25b4699f777810a627634eb8078dcbbb19317ed27a9b0d5 \n\n\n\n\n\u00a0\n\nFor instructions on installation and verification of the hotfix patch, refer to the  \u201cmanaging eos extensions\u201d https://www.arista.com/en/um-eos/eos-managing-eos-extensions \u00a0section in the EOS User Manual. Ensure that the patch is made persistent across reboots by running the command \u2018copy installed-extensions boot-extensions\u2019.\n\n\n"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "HIGH",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 5.9,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "NONE",
                "integrityImpact": "NONE",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
                "version": "3.1"
            }
        ]
    }
}