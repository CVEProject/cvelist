{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2023-6068",
        "ASSIGNER": "psirt@arista.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On affected 7130 Series FPGA platforms running MOS and recent versions of the MultiAccess FPGA, application of ACL\u2019s may result in incorrect operation of the configured ACL for a port resulting in some packets that should be denied being permitted and some"
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-283",
                        "cweId": "CWE-283"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Arista Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "MOS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "1.7.1"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "1.6"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/19023-security-advisory-0091",
                "refsource": "MISC",
                "name": "https://www.arista.com/en/support/advisories-notices/security-advisory/19023-security-advisory-0091"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "defect": [
            "BUG 869667"
        ],
        "discovery": "INTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>In order to be vulnerable to CVE-2023-6068, the following condition must be met:</p><p>MOS must be configured with MultiAccess FPGA software versions 1.7.1 or 1.6.x and can be determined by running the show version command and referring to the highlighted section as shown below.</p><pre>switch(config)#show version\nDevice: Metamako MetaMux 48 with L-Series\nSKU: DCS-7130-48LB\nSerial number: M48LB-A3-27719-4\n   \nSoftware image version: 0.39.0alpha4\nInternal build ID: master+9345\n<span style=\"background-color: rgb(255, 255, 0);\">Applications: multiaccess-1.7.1</span></pre><br>"
                }
            ],
            "value": "In order to be vulnerable to CVE-2023-6068, the following condition must be met:\n\nMOS must be configured with MultiAccess FPGA software versions 1.7.1 or 1.6.x and can be determined by running the show version command and referring to the highlighted section as shown below.\n\nswitch(config)#show version\nDevice: Metamako MetaMux 48 with L-Series\nSKU: DCS-7130-48LB\nSerial number: M48LB-A3-27719-4\n   \nSoftware image version: 0.39.0alpha4\nInternal build ID: master+9345\nApplications: multiaccess-1.7.1\n\n\n"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The workaround is to only apply one access-list to any particular port after the MultiAccess image is loaded into the FPGA. If a new access-list is to be applied to a port, the FPGA image should be reloaded after the access-list is applied.</p><p>Run the following commands to reload the FPGA image, where the line in yellow represents new access control lists to be added:</p><pre>switch(config-app-multiaccess)#shut\nswitch(config-app-multiaccess)<span style=\"background-color: rgb(255, 255, 0);\">#multiaccess-group 0 client 0 access-list new_acl_if_need</span>\nswitch(config-app-multiaccess)#no shut\n</pre><p>The previous applied access control lists will automatically apply after FPGA reload.</p><br>"
                }
            ],
            "value": "The workaround is to only apply one access-list to any particular port after the MultiAccess image is loaded into the FPGA. If a new access-list is to be applied to a port, the FPGA image should be reloaded after the access-list is applied.\n\nRun the following commands to reload the FPGA image, where the line in yellow represents new access control lists to be added:\n\nswitch(config-app-multiaccess)#shut\nswitch(config-app-multiaccess)#multiaccess-group 0 client 0 access-list new_acl_if_need\nswitch(config-app-multiaccess)#no shut\n\n\nThe previous applied access control lists will automatically apply after FPGA reload.\n\n\n"
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<span style=\"background-color: rgb(255, 255, 255);\">This issue was discovered internally and Arista is not aware of any malicious uses of this issue in customer networks.</span><br>"
                }
            ],
            "value": "This issue was discovered internally and Arista is not aware of any malicious uses of this issue in customer networks.\n"
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below.</p><p>CVE-2023-6068 has been fixed in the following releases:</p><ul><li>MultiAccess FPGA 1.8.0 and later</li></ul><br>"
                }
            ],
            "value": "The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below.\n\nCVE-2023-6068 has been fixed in the following releases:\n\n  *  MultiAccess FPGA 1.8.0 and later\n\n\n\n"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "HIGH",
                "attackVector": "NETWORK",
                "availabilityImpact": "NONE",
                "baseScore": 3.1,
                "baseSeverity": "LOW",
                "confidentialityImpact": "NONE",
                "integrityImpact": "LOW",
                "privilegesRequired": "LOW",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N",
                "version": "3.1"
            }
        ]
    }
}